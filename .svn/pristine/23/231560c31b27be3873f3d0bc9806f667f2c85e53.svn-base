<div class="main-content">
    <div id="userAddgroup" class="popLayer">
        <div class="breadcrumbs">
            <ul class="breadcrumb">
                <li>添加用户组</li>
            </ul>
            <!-- .breadcrumb -->
            <span class="floatRig closePop">关闭</span>
        </div>
        <div class="col-sm-12">
            <div class="row">
                <div class="col-xs-win">
                    <!-- PAGE CONTENT BEGINS -->
                    <form style="position:relative;margin-top:20px;" id="usergroup_form" class="form-horizontal" role="form">

                        <div class="form-group">
                            <label class="col-sm-3 control-label no-padding-right"> 用户组 </label>

                            <div class="col-sm-9">
                                <input type="text" name="usergroup_name" placeholder="用户组"  pattern="^\S{1,18}$"  title="请输入小于1-18位字符" class="col-xs-10 col-sm-5" required />
                            </div>
                        </div>

                        <div class="space-4"></div>

                        <div class="form-group">

                            <label class="col-sm-3 control-label no-padding-right"> 备注 </label>

                            <div class="col-sm-9">
                                <textarea type="text" name="note" class="col-xs-10 col-sm-5" ></textarea>
                            </div>
                        </div>


                        <div class="space-4"></div>
                        <div class="clearfix form-actions">
                            <div>
                                <button class="btn btn-info" type="submit">
                                    <i class="icon-ok bigger-110"></i>
                                    提交
                                </button>

                                &nbsp; &nbsp; &nbsp;
                                <button class="btn" type="reset">
                                    <i class="icon-undo bigger-110"></i>
                                    取消
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
                <!-- /.col -->
            </div>
            <!-- /.row -->
        </div>
    </div>
    <div id="ajaxAlert"  class="popLayer" style="top:100px;left:50%;width: 20%;margin-left:-10%;">
        <div class="breadcrumbs">
            <ul class="breadcrumb">
                <li>
                    提示
                </li>
            </ul>
            <!-- .breadcrumb -->
            <span class="floatRig closePop"></span>
        </div>
            <div class="tipText">
        
            </div>
    </div>
    <div id="editeUsergroup" class="popLayer">
        <div class="breadcrumbs">
            <ul class="breadcrumb">
                <li>编辑用户组</li>
            </ul>
            <!-- .breadcrumb -->
            <span class="floatRig closePop">关闭</span>
        </div>
        <div class="col-sm-12">
            <div class="row">
                <div class="col-xs-win">
                    <!-- PAGE CONTENT BEGINS -->
                    <form style="position:relative;margin-top:20px;" id="editeusergroup_form" class="form-horizontal" role="form">

                        <div class="form-group">
                            <label class="col-sm-3 control-label no-padding-right">用户组 </label>

                            <div class="col-sm-9">
                                <input type="text" name="groupname" placeholder="用户组"  pattern="^\S{1,18}$"  title="请输入小于1-18位字符" class="col-xs-10 col-sm-5"
                                        required/>
                            </div>
                        </div>

                        <div class="space-4"></div>

                        <div class="form-group">
                            <label class="col-sm-3 control-label no-padding-right">备注</label>

                            <div class="col-sm-9">
                                <textarea type="text" name="note" class="col-xs-10 col-sm-5" required></textarea>
                            </div>
                        </div>

                        <input type="hidden" id='id' name='id' />

                        <div class="clearfix form-actions">
                            <div>
                                <button class="btn btn-info" type="submit">
                                    <i class="icon-ok bigger-110"></i>
                                    提交
                                </button>

                                <!--
                                <button class="btn" type="reset">
                                    <i class="icon-undo bigger-110"></i>
                                    取消
                                </button>
                                -->
                            </div>
                        </div>
                    </form>
                </div>
                <!-- /.col -->
            </div>
            <!-- /.row -->
        </div>
    </div>
    <div id="delUser" class="popLayer" style="top:100px;left:50%;width: 40%;margin-left:-20%;">
        <div class="breadcrumbs">
            <ul class="breadcrumb">
                <li>
                    删除用户组
                </li>
            </ul>
            <!-- .breadcrumb -->
            <span class="floatRig closePop">关闭</span>
        </div>
        <div class="col-sm-12">
            <div class="row">
                <div class="col-xs-win">
                    <!-- PAGE CONTENT BEGINS -->
                    <form style="position:relative;top:20px;" id="delgroup_form" class="form-horizontal" role="form">

                        <div class="form-group">
                            <label class="col-sm-4 control-label no-padding-right"> 确定要删除用户组？ </label>
                        </div>

                        <!-- <input type="hidden" name="id" value="{$template_data['id']}" /> -->
                        <div class="clearfix form-actions">
                            <div>
                                <button class=" btn btn-danger" type="">
                                    <i class="icon-remove  bigger-110 "></i>
                                    删除
                                </button>

                                &nbsp; &nbsp; &nbsp;
                                <button class="btn" type="reset">
                                    <i class="icon-undo bigger-110"></i>
                                    取消
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
                <!-- /.col -->
            </div>
            <!-- /.row -->
        </div>
    </div>
    <div id="fade" class="black_overlay"></div>
                  <div class="breadcrumbs" id="breadcrumbs">
                        <script type="text/javascript">
                            try{ace.settings.check('breadcrumbs' , 'fixed')}catch(e){}
                        </script>

                        <ul class="breadcrumb">
                            <li>
                                权限管理
                            </li>
                            <li class="active">用户组管理</li>
                        </ul><!-- .breadcrumb -->

<!-- #nav-search -->
                    </div>
                    <div class="col-sm-12">
                    <div class="row">
                        <div class="col-xs-12">
                        
                    <!-- <div class="formArea marT10" >
                    <form method="get"  action="">
                                       
                    用户组：
                    <select name="usergroup" class="usergroup">
                            <option value="">请选择</option>
                            <volist name="group_data" id="group_data_vo" >
                                  <option value="{$group_data_vo['id']}">{$group_data_vo['title']}</option>
                            </volist>
                         </select>
                                       
                    <button class="aptSearchBtn "><i class="fa fa-search"></i>查询</button>
                    </form>
                    
                                    </div> -->
                
                
                <div class="aptTable span10 marT10 tableShow" style="display: none">
                <div class="aptListBtnGroup " >
                <!-- <a href="#"><i class="icon-upload-alt blue"></i>导出</a> -->
                <a href="#" id="usergroupAdd"><i class="icon-plus-sign bigger-120 green"></i>添加</a>
                <a href="#" id="usergroupDel"><i class="icon-remove  bigger-120 red "></i>删除</a>
                </div>
				<!--<table data-toggle="table" id="sample-table-1" data-striped="true" data-pagination="true" data-show-columns="true">
                    <thead>
                            <tr>
                               <th><input type="checkbox" ></th>
                                            <th>用户组</th>
                                            <th>备注</th>
                                            <th>操作</th>
                            </tr>
                    </thead>
                    <tbody>
                       <volist name="usergroup_data" id="usergroup_data_vo" >
                                        <tr>
                                            <td><input type="checkbox" name="checkbox" value="{$usergroup_data_vo['id']}"></td>
                                            <td>{$usergroup_data_vo['title']}</td>
                                            <td><if condition="$usergroup_data_vo['note'] eq ''">&#45;&#45;<else />{$usergroup_data_vo['note']}</if></td>
                                            <td>
                                               
                                                <a href="__URL__/authorize/id/{$usergroup_data_vo['id']}" style="margin-right:4px;" title="权限设置"><i class="icon-key bigger-130 blue icon-flip-horizontal"></i></a>
							
							<a class="green editeUsergroup" href="javascript:;" title="编辑"  style="margin-right:4px;" ><i class="icon-pencil bigger-130"></i></a>

							<a class="red" href="#" title="删除"><i class="icon-trash delUsergroup bigger-130"></i></a>

                                                
                                            </td>
                                        </tr>
                                       </volist>
                    </tbody>
                </table>
                <div style="position: absolute;bottom: 10px;left: 500px">
                    {$show}
                </div>-->
                    <table id="reportTable">
                    </table>
			</div>
                
                
            </div>   
                        
                           
                        
                           
                        </div>
                    </div>
                    
                </div>
    <div style="clear: both"></div>
                                </div>

<script>
    $(document).ready(function(){
        function operateFormatter(value, row, index) {
            return [
                '<a href="#" style="margin-right:4px;" title="权限设置"><i class="icon-key bigger-130 blue icon-flip-horizontal"></i></a>' +
                '<a class="green editeUsergroup" href="javascript:;" title="编辑"  style="margin-right:4px;" ><i class="icon-pencil bigger-130"></i></a>'+
                '<a class="red" href="#" title="删除"><i class="icon-trash delUsergroup bigger-130"></i></a>'
            ].join('');
        }
        var rowId = new Array();
        $('#reportTable').bootstrapTable({
            method: 'get',
//            url: '__URL__/ugeventOK',
            //search:true,
            cache: false,
            //height: 400,
            striped: true,
//            sidePagination:"server",
            pagination: true,
            pageSize: 10,
            pageNumber: 1,
            pageList: [10],
            sortName : 'time',
            sortOrder : 'desc',
            showColumns: true,
            formatLoadingMessage: function () {
                return "请稍等，正在加载中...";
            },
            formatNoMatches: function () {  //没有匹配的结果
                return '无符合条件的记录';
            },
            queryParams: function (params) {
                var pars = {
                    //keyword:$('#keyword').val(),
                    pagenum:params.offset/params.limit+1,
                    order:params.order,
                    sort:params.sort
                };
                return pars;
            },
            columns: [{
                checkbox:true,
            },{
                field: "usergroup",
                title: "用户组",
                align: "center",
                valign: "middle",
                sortable: false
            },{
                field: "remark",
                title: "备注",
                align: "center",
                valign: "middle",
                sortable: false
            },{
                field: "id",
                title: "操作",
                align: "center",
                valign: "middle",
                sortable: false,
                switchable: false,
                formatter: operateFormatter
            }],
            data: [{
                "usergroup": "czu",
                "remark": "zu",
                "place_set": 'false',
            },{
                "usergroup": "2zu",
                "remark": "aa",
                "place_set": "-",
            }],
            onLoadSuccess:function(data){
                console.log("ok");
            },
            responseHandler:function(res) {
                var tem = {"total":0,"rows":[]};
                if(res.status){
                    tem.total = res.totalNum;
                    tem.rows = eval(res.data);
                }else{
                    $('#reportTable').bootstrapTable('removeAll');
                }
                return tem;
            },
            onLoadError:function(status,res){
                $('#reportTable').bootstrapTable('removeAll');
                console.log(status,res);
            }
        });

        $(window).resize(function () {
            $('#reportTable').bootstrapTable('resetView');
        });
    });
    $('#sample-table-1 tbody tr').each(
        function(){
        var aa = $(this).children('td:eq(1)').html();
         if (aa =='超级管理员') {
            $(this).children('td:eq(0)').children('input').remove();
            $(this).children('td:eq(3)').children('a').remove();
         };

        });

	$(document).on("click","#usergroupAdd",function(){			
        $("#userAddgroup").show();
        $("#fade").show();
        return false
    });
    $(".closePop").css("cursor", "pointer").click(function () {
        $("#userAddgroup").hide();
        $("#delUser").hide();
        $("#editeUsergroup").hide();
        $("#fade").hide();
        $(":checked").attr('checked',false);
    });

	$(document).on("click","#usergroupDel",function(){		
        var ids= $("input:checkbox[name='checkbox']:checked").map(function() {
            return $(this).val();
        }).get().join(',');
        if(ids==''||ids=='on'){
            $(':checked').attr('checked',false);
            layer.msg('请选择要删除的数据');
        }else{
            if(ids.indexOf("on,") >= 0){
               ids = ids.replace(/on,/g,'');
            }
            $("#delUser").show();
            $("#fade").show();
        }
        return false;
    });


	$(document).on("click",".editeUsergroup",function(){	
        var tr = $(this).parents('tr');
        $("#editeusergroup_form input[name='id']").val(tr.children('td:eq(0)').children().val());
        $("#editeusergroup_form input[name='groupname']").val(tr.children('td:eq(1)').html());
        $("#editeusergroup_form textarea[name='note']").val(tr.children('td:eq(2)').html());
        $("#editeUsergroup").show();
        $("#fade").show();
        //return false
    })


	$(document).on("click",".delUsergroup",function(){	
        $(":checked").attr('checked',false);
        $(this).parents('tr').children().first().children().attr('checked','checked');
        $("#delUser").show();
        $("#fade").show();
        return false
    })

    $('#delgroup_form').submit(function(e){
        e.preventDefault();
        var id = $("input:checkbox[name='checkbox']:checked").map(function() {
                return $(this).val();
            }).get().join(',');
        $.ajax({
            url:'__URL__/usergroupdel',
            type:'POST',
            dataType:'json',
            data:{'id':id},
            success:function(data){
                $("#delUser").hide();
                $("#fade").hide();
                $('#delgroup_form')[0].reset();
                layer.msg(data.msg);
                window.location.reload();
                $(":checked").attr('checked',false);
            }
       });
    })

    $('#editeusergroup_form').submit(function(e){
        e.preventDefault();
        var data = $('#editeusergroup_form').serialize();
        $.ajax({
            url:'__URL__/do_usergroup_edite',
            type:'POST',
            dataType:'json',
            data:data,
            success:function(data){
                if(data.status=='success'){
                   $("#editeUsergroup").hide();
                   $("#fade").hide();
                   $('#editeusergroup_form')[0].reset();
                    layer.msg(data.msg);
                    window.location.reload();
                }else if(data.status=='error'){
                    layer.msg(data.msg);
                }
            }
       });
    })

    $('#usergroup_form').submit(function(e){
        e.stopPropagation();
        e.preventDefault();
        var usergroup_data = $('#usergroup_form').serialize();
        $.ajax({
            url:'__URL__/usergroup_add',
            type:'POST',
            dataType:'json',
            data:usergroup_data,
            success:function(data){
                if(data.status=='success'){
                    $("#userAddgroup").hide();
                    $("#fade").hide();
                    layer.msg(data.msg);
                    window.location.reload();
                }else if(data.status=='error'){
                    layer.msg(data.msg);
                }
            }
        });
    });


            // $('#usergroup_form').submit(function(e){
            //    e.stopPropagation();
            //    e.preventDefault();
            //    var usergroup_data = $('#usergroup_form').serialize();
            //    $.ajax({
            //     url:'__URL__/usergroup_add',
            //     type:'POST',
            //     dataType:'json',
            //      data:usergroup_data,
            //      success:function(data){
            //         if(data.status=='success'){
            //             alert('成功');
            //         }
            //      }
            //   });
            // });

            // $('.usergroup_edite').click(function(){
            //   var id = $(this).next().next().val();
            //   window.location.href='__URL__/usergroup_edite?id='+id;
            // });

            // $('#usergroup_edite_form').submit(function(e){
            //    e.stopPropagation();
            //    e.preventDefault();
            //    var usergroup_data = $('#usergroup_edite_form').serialize();
            //    $.ajax({
            //     url:'__URL__/do_usergroup_edite',
            //     type:'POST',
            //     dataType:'json',
            //      data:usergroup_data,
            //      success:function(data){
            //         if(data.status=='success'){
            //             alert('成功');
            //         }else{
            //             alert('xml');
            //         }
            //      }
            //   });
            // });
</script>