<div class="main-content">
    <div id="addUser" class="popLayer" >
        <div class="breadcrumbs">
            <ul class="breadcrumb">
                <li>标记</li>
            </ul>
            <!-- .breadcrumb -->
            <span class="floatRig closePop">关闭</span>
        </div>
        <div class="col-sm-12" style="height: 260px">
            <div class="row">
                <div class="col-xs-win">
                    <!-- PAGE CONTENT BEGINS -->
                    <form style="position:relative;margin-top:20px;" id="addUser_form" class="form-horizontal" role="form">



                        <div class="space-4"></div>


                        <div class="form-group" style="height: 160px">



                        </div>


                        <div class="space-4"></div>

                        <!-- <input type="hidden" name="id" value="{$template_data['id']}" /> -->
                        <div class="clearfix form-actions">
                            <div>
                                <button class="btn btn-info" type="submit">
                                    <i class="icon-ok bigger-110"></i>
                                    确定
                                </button>



                            </div>
                        </div>
                    </form>
                </div>
                <!-- /.col -->
            </div>
            <!-- /.row -->
        </div>
    </div>
    <div id="ignore" class="popLayer" >
        <div class="breadcrumbs">
            <ul class="breadcrumb">
                <li>忽略</li>
            </ul>
            <!-- .breadcrumb -->
            <span class="floatRig closePop">关闭</span>
        </div>
        <div class="col-sm-12" style="height: 260px">
            <div class="row">
                <div class="col-xs-win">
                    <!-- PAGE CONTENT BEGINS -->
                    <!--<form style="position:relative;margin-top:20px;" class="form-horizontal" role="form">-->

                        <div class="space-4"></div>
                        <div class="form-group" style="height: 160px">
                                <!--<h3>确定要忽略吗?</h3>-->
                        </div>


                        <div class="space-4"></div>

                        <!-- <input type="hidden" name="id" value="{$template_data['id']}" /> -->
                        <div class="clearfix form-actions">
                            <div>
                                <button class="btn btn-info" type="submit">
                                    <i class="icon-ok bigger-110"></i>
                                    确定
                                </button>
                                <!--<button class="btn" type="reset">
                                    <i class="icon-undo bigger-110"></i>
                                    取消
                                </button>-->



                            </div>
                        </div>
                    <!--</form>-->
                </div>
                <!-- /.col -->
            </div>
            <!-- /.row -->
        </div>
    </div>

    <div class="breadcrumbs" id="breadcrumbs">
        <script type="text/javascript">
            try {
                ace.settings.check('breadcrumbs', 'fixed')
            } catch (e) {
            }
        </script>

        <ul class="breadcrumb">
            <li>
                紧急事件
            </li>
            <li class="active">紧急事件</li>
        </ul>
        <!-- .breadcrumb -->
        <!-- #nav-search -->
    </div>

    <!--<div>12</div>-->

        <div class="col-sm-12">
            <div class="row">
                <div class="col-xs-12">
                    <div class="formArea marT10" >
                        <form method="get"  action="">
                            <label class="floatLeft">时间：</label>
                            <div class="input-group w300 floatLeft" style="width:281px; text-indent:0px;">
			                    <span class="input-group-addon">
                                    <i class="icon-calendar bigger-110"></i>
			                     </span><input class="form-control date-range-picker" type="text" name="date-range-picker" data-date-format="YYYY-MM-DD"
                                               id="id-date-range-picker-1"/>
                            </div>

                            <button class="aptSearchBtn "><i class="fa fa-search"></i>查询</button>
                        </form>
                    </div>

                    <!--<div class="buttonGroup" style="float: left">
                        <a href="#" class="btn btn-link" id="userAdd"><i class="icon-plus-sign bigger-120 green"></i>添加</a>|
                        <a href="#" class="btn btn-link" id="userDel"><i class="icon-remove  bigger-120 red "></i>删除</a>
                    </div>
                    -->
                    <div class="chartBox marT10" style="position: relative">
                        <!--<div>
                            <div id="container" style=" width:452px;height:288px;float: left"></div>
                            <div id="container2" style=" width: 668px;height:288px; float:right"></div>

                        </div>-->


                        <div class="aptBox aptBoxW4 aptBoxH3" >
                            <div id="container" style=" width:98%;height:100%;"></div>
                        </div>

                        <div class="aptBox aptBoxW6 aptBoxH3 marL10" >
                            <div id="container2" style=" width: 98%;height:100%;" ></div>
                        </div>
                        <!--30天紧急事件趋势图的翻页-->
                        <div class=" aptBoxW6 " style="position: absolute;right: 1px;bottom: 40px">
                            <a href="#" style="position: absolute;top: 2px;left: 60px" title="查看上一周期" >
                                <i class="icon-caret-left icon-2x"></i>
                            </a>

                            <a href="#"  style="position: absolute;top: 2px;right: 10px" title="查看下一周期">
                                <i class="icon-caret-right icon-2x" ></i>
                            </a>
                        </div>
                        <div class="clearBoth"></div>
                    </div>


                    <!-- 表格的筛选栏-->
                    <div class="formArea marT10" id="type" >
                        <label class="floatLeft">时间：</label>
                        <div class="input-group w300 floatLeft" style="width:281px; text-indent:0px;">
			                    <span class="input-group-addon">
                                    <i class="icon-calendar bigger-110"></i>
			                     </span><input class="form-control date-range-picker" type="text" name="date-range-picker" data-date-format="YYYY-MM-DD"
                                               id="id-date-range-picker-2"/>
                        </div><a href="#" class="aptSearchBtn">查询</a>
                        <p class="atpTypeList">
                            类型：<a class="sel">全部(<span>18</span>)</a>
                            <a class="sqlSeccuss">SQL注入成功(<span>2</span>)</a>
                            <a class="chickenWay">鸡肉行为(<span>0</span>)</a>
                            <a class="helminth">蠕虫病毒(<span>2</span>)</a>
                            <a class="cockhorse">木马回连(<span>1</span>)</a>
                            <a class="ddos">DDoS(<span>3</span>)</a>
                            <a class="code">代码/命令执行(<span>6</span>)</a>
                            <a class="noLogin">非正常登录(<span>0</span>)</a>
                            <a class="abnormalConn">异常网络连接(<span>3</span>)</a>
                            <a class="nodown">未授权下载(<span>0</span>)</a>
                            <a class="webshell">webshell(<span>1</span>)</a>



                        <div class="clearBoth"></div>

                    </div>

                    <div class="aptTable span10 marT10 tableShow" style="display: none">
                        <div class="aptListBtnGroup"><h4><b>30</b>天紧急事件分布</h4></div>
                        <!--<div class="aptListBtnGroup"><a href="#"><i class="icon-upload-alt"></i>导出</a></div>-->
                        <table data-toggle="table" data-striped="true" data-pagination="true" data-search="true"  data-show-columns="true">
                            <thead>
                            <tr>

                                <th data-field="time">发生时间</th>
                                <th data-field="type">事件类型</th>
                                <th data-field="price">受影响资产</th>
                                <th data-field="id">事件描述</th>
                                <th data-field="name">标记</th>
                                <th data-field="set">操作</th>

                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>2017-03-13 15:30:29</td>
                                <td>webshell</td>
                                <td>N-SMLUE-PUL-A03</td>
                                <td>logins.action页面存在struts2(045)漏洞发现已经上传webshell</td>
                                <td>
                                    未标记
                                </td>
                                <td><a href="#" class="ignore" title="忽略"><i class="icon-eye-open" style="color:#F00"></i></a><a href="#" class="marL10 sign" title="标记"><i class="icon-pushpin" style="color:#06F"></i></a></td>
                            </tr>
                            <tr>
                                <td>2017-03-13 15:26:32</td>
                                <td>SQL注入</td>
                                <td>N-SMLUE-PUL-A22</td>
                                <td>login.php页面存在post类型注入，发现已经产生注入报文</td>
                                <td>
                                    未标记
                                </td>
                                <td><a href="#" class="ignore"  title="已忽略"><i class="icon-eye-close" style="color:#999"></i></a><a href="#" id="" class="marL10 sign" title="标记"><i class="icon-pushpin" style="color:#06F"></i></a></td>
                            </tr>
                            <tr>
                                <td>2017-03-13 15:24:21</td>
                                <td>SQL注入</td>
                                <td>N-SMLUE-PUL-A01</td>
                                <td>user_Reg.jsp?it=12页面存在get类型注入，发现已经产生注入报文</td>
                                <td>
                                    未标记
                                </td>
                                <td><a href="#" class="ignore"  title="已忽略"><i class="icon-eye-close" style="color:#999"></i></a><a href="#" id="" class="marL10 sign" title="标记"><i class="icon-pushpin" style="color:#06F"></i></a></td>
                            </tr>
                            <tr>
                                <td>2017-03-13 15:12:19</td>
                                <td>代码/命令执行</td>
                                <td>N-SMLUE-SSL-B12</td>
                                <td>regLogin.action页面存在struts2(045)漏洞，发现漏洞测试报文</td>
                                <td>
                                    未标记
                                </td>
                                <td><a href="#" class="ignore"  title="已忽略"><i class="icon-eye-close" style="color:#999"></i></a><a href="#" id="" class="marL10 sign" title="标记"><i class="icon-pushpin" style="color:#06F"></i></a></td>
                            </tr>

                            </tbody>
                        </table>
                    </div>


                </div>
            </div>

        </div>



</div>
<script>
    $(document).on("click",".sign",function(){
//        alert(1);
        $("#addUser").show();
        $("#fade").show();
        return false
    });
    $('#addUser_form').submit(function(e){
        e.stopPropagation();
        e.preventDefault();
        $("#addUser").hide();
        $("#delUser").hide();
        $("#fade").hide();
            $.ajax({
                type: "POST",
                url: "__URL__/user_add",
                data: data,
                dataType: "json",
                success:function(data){

                }
            });

    })
    $(".closePop").css("cursor", "pointer").click(function () {
        $("#addUser").hide();
        $("#ignore").hide();
        $("#fade").hide();
        $(":checked").attr('checked',false);
    });

    $(document).on("click",".ignore",function(){
//        alert(1);
        $("#ignore").show();
        $("#fade").show();
        return false
    });
</script>
<script>

    jQuery(function ($) {
        $('input[name=date-range-picker]').daterangepicker({
                    startDate: moment().subtract(30, 'days'),
                    endDate: moment(),
                    locale : {
                        applyLabel: '提交',
                        cancelLabel: '取消',
                        fromLabel: '开始时间',
                        toLabel: '结束时间',
                        weekLabel: 'W',
                        customRangeLabel: 'Custom Range',
                        daysOfWeek: ['日', '一', '二', '三', '四', '五','六'],
                        monthNames: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'],
                        firstDay: moment.localeData()._week.dow
                    },
//                    endDate: moment(),

//                    startDate: moment().startOf('day'),
//                    minValidDate: '315507600000000000000000', //最小可用时间，控制日期选择器的可选力度
                    dateLimit : {
                        day : 30
                    },
                    timePickerIncrement : 1440, //时间的增量，单位为分钟
                    language: 'cn',}
        ).prev().on(ace.click_event, function () {
                    $(this).next().focus();
                });

    })
</script>
<script>
    var chart1=function(data){
        $('#container').highcharts({
            colors: ['#c63012', '#ea7f0c', '#cbf621', '#7798BF', '#aaeeee', '#ff0066', '#eeaaee',
                '#55BF3B', '#DF5353', '#7798BF', '#aaeeee'
            ],
            /*colors: ['#99CDFB', '#3366FB', '#0000FA', '#F8CC00', '#F89900', '#F76600', '#eeaaee',
                '#55BF3B', '#DF5353', '#7798BF', '#aaeeee'
            ],*/
            /*colors: ['#427AA0', '#4687B5', '#519BCE', '#66B0E6', '#70BDF1', '#8DCAF1', '#CDE8FA'
            ],*/
            chart:{
                backgroundColor: '#fefefe',
                type: 'pie',
                options3d: {
                    enabled: true,
                    alpha: 70,
                    beta: 0
                },
            },
            title: {
                text: '30日紧急事件分布',
                y:28
            },
            credits:{
                enabled:false // 禁用版权信息
            },
            tooltip: {
                pointFormat: '攻击占比: <b>{point.percentage:.1f}%</b><br>'+'{series.name}: <b>{point.y}</b>'
            },
            exporting: {
                enabled: false
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    depth: 25,
                    dataLabels: {
                        enabled: true,
                        //format: '{point.name}'
                        format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                        style: {
                            color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                        }
                    },
                }
            },
            series: [{
                type: 'pie',
                name: '攻击数',
                data: [['SQL注入成功',2],['DDoS',3],['代码/命令执行',6],['异常网络连接',3],['其他',4]]
            }]
        });
    }
       /* $(function () {
            $('#container').highcharts({
				colors: ['#c63012', '#ea7f0c', '#cbf621', '#7798BF', '#aaeeee', '#ff0066', '#eeaaee',
                '#55BF3B', '#DF5353', '#7798BF', '#aaeeee'
            ],
                chart:{
                    backgroundColor: '#fefefe',
                    type: 'pie',
                    options3d: {
                        enabled: true,
                        alpha: 70,
                        beta: 0
                    },
                },
                title: {
                    text: '最近30日紧急事件分布',
                    y:28
                },
                credits:{
                    enabled:false // 禁用版权信息
                },
                tooltip: {
                    pointFormat: '攻击占比: <b>{point.percentage:.1f}%</b><br>'+'{series.name}: <b>{point.y}</b>'
                },
                exporting: {
                    enabled: false
                },
                plotOptions: {
                    pie: {
                        allowPointSelect: true,
                        cursor: 'pointer',
                        depth: 25,
                        dataLabels: {
                            enabled: true,
                            //format: '{point.name}'
                            format: '<b>{point.name}</b>: {point.percentage:.1f} %',
                            style: {
                                color: (Highcharts.theme && Highcharts.theme.contrastTextColor) || 'black'
                            }
                        },
                    }
                },
                series: [{
                    type: 'pie',
                    name: '攻击数',
                    data: [['SQL注入成功',30],['鸡肉行为',40],['蠕虫病毒',40],['木马回连',20],['DDoS',22],['非正常登陆',14],['其他',10]]
                }]
            });
        });*/
        var chart2=function(data){
            $('#container2').highcharts({
                chart: {
                    type: 'column'


                },
                title: {
                    text: '30天告警分析趋势图',
                    y:28
                },
                credits:{
                    enabled:false // 禁用版权信息
                },
                xAxis: {
                    type: 'category',
                    labels: {
                        style: {
                            fontSize: '14px',
                            fontFamily: 'Verdana, sans-serif'
                        }
                    },
                },
                yAxis: {
                    min: 0,
                    title: {
                        text: '数量(个)'
                    }
                },
                legend: {
                    enabled: false
                },
                tooltip: {
                    formatter: function () {
                        return '<b>' + this.x + '</b><br/>' +
                                '告警类别: ' + this.series.name + '<br/>' +
                                '个数: ' + this.y;
                    }
                },
                plotOptions: {
                    column: {
                        stacking: 'normal',
                    }
                },
                series: [{
                    name: 'SQL注入',
//                    color:'#BAC4E2',
                    color:'#9DC0DC',
                    data: [
                        ['3-8',2],['3-9',3],['3-10',0],['3-11',1],['3-12',2],['3-13',0], ['3-14',5],['3-15',3],
                        ['3-16',1],
                        ['3-17',2]
                    ]
                }, {
                    name: '非正常登陆',
//                    color:'#8EA1D3',
//                    color:'#CCE8FD',

                    color:'#FEDC57',


                    data: [
                        ['3-8',2],['3-9',3],['3-10',0],['3-11',1],['3-12',1],['3-13',0], ['3-14',5],['3-15',3],
                        ['3-16',0],
                        ['3-17',1]
                    ]
                }, {
                    name: '鸡肉行为',
//                    color:'#315393',

                    color:'#A7CC3E',
                    data: [
                        ['3-8',2],['3-9',3],['3-10',2],['3-11',1],['3-12',2],['3-13',0], ['3-14',1],['3-15',3],
                        ['3-16',0],
                        ['3-17',2]
                    ]
                }]
            });


        }

    //当左侧菜单栏显示或隐藏时图表重绘
    $('.icon-double-angle-left').click(function(){
        if($('.col-xs-12').css("width")!=$('.main-content').css("min-width")){
            if($('#sidebar-collapse i').attr('class')=='icon-double-angle-left'){

                setTimeout(function(){
                    $('#container2').highcharts().reflow();
                },1)
            }else{
                setTimeout(function(){
//                    $('#container2').css("width",$('#container2').css("width"))
                    $('#container2').highcharts().reflow();
                },1)
            }

            $('#container2').highcharts().reflow();

        }
    });

        chart1();
        chart2();
       /* $(function(){
            $('#container2').highcharts({
                chart: {
                    type: 'column'
                },
                title: {
                    text: '30天告警分析趋势图',
                    y:28
                },
                credits:{
                    enabled:false // 禁用版权信息
                },
                xAxis: {
                    type: 'category',
                    labels: {
                        style: {
                            fontSize: '14px',
                            fontFamily: 'Verdana, sans-serif'
                        }
                    },
                },
                yAxis: {
                    min: 0,
                    title: {
                        text: '数量(个)'
                    }
                },
                legend: {
                    enabled: false
                },
                tooltip: {
                    formatter: function () {
                        return '<b>' + this.x + '</b><br/>' +
                                '告警类别: ' + this.series.name + '<br/>' +
                                '个数: ' + this.y;
                    }
                },
                plotOptions: {
                    column: {
                        stacking: 'normal',
                    }
                },
                series: [{
                    name: 'SQL注入',
                    data: [
                        ['3-8',2],['3-9',3],['3-10',4],['3-11',1],['3-12',2],['3-13',2], ['3-14',5],['3-15',3],
                        ['3-16',2],
                        ['3-17',2]
                    ]
                }, {
                    name: '非正常登陆',
                    data: [
                        ['3-8',2],['3-9',3],['3-10',4],['3-11',1],['3-12',2],['3-13',2], ['3-14',5],['3-15',3],
                        ['3-16',2],
                        ['3-17',2]
                    ]
                }, {
                    name: '鸡肉行为',
                    data: [
                        ['3-8',2],['3-9',3],['3-10',4],['3-11',1],['3-12',2],['3-13',2], ['3-14',5],['3-15',3],
                        ['3-16',2],
                        ['3-17',2]
                    ]
                }]
            });
        })*/

      /*  $(function () {
    $('#container2').highcharts({
        title: {
            text: '最近30日紧急事件趋势',
            x: -20
        },
		credits:{
                    enabled:false // 禁用版权信息
                },
        xAxis: {
			type: 'datetime',
                dateTimeLabelFormats: {
                    millisecond: '%H:%M:%S.%L',
                    second: '%H:%M:%S',
                    minute: '%H:%M',
                    hour: '%H:%M',
                    day: '%m-%d',
                    week: '%m-%d',
                    month: '%Y-%m',
                    year: '%Y'
                }},
        yAxis: {
            title: {
                text: '单位'
            },
            plotLines: [{
                value: 0,
                width: 1,
                color: '#808080'
            }]
        },
        tooltip: {
            valueSuffix: '°C'
        },
        legend: {
            borderWidth: 0
        },
        series: [{
            name: '网络入侵',
            data: [[1486656000000,7.0],[1486569600000,7.0]]
        }]
    });
});*/

		</script>
