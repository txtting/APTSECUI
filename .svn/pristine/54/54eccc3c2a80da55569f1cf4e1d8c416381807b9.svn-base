<?php
namespace Home\Controller;

class VirController extends CommonController {
    public function getdatastr($data,$col1,$col2){
        $str = "[";
        for ($i=0; $i < count($data) ; $i++) { 
            $str .="['".$data[$i][$col1]."',".$data[$i][$col2]."],";
        }
        $str .= "]";
        return $str;
    }
    public function index(){
        Layout('Layout/layout');
        $this->display();
    }
    public function indexdata(){
        $end = time();
        $start = $end -30*24*3600;
        $data=[];
        $data['data1'] = $this -> indexdata1($start,$end);
        $data['data2'] = $this -> indexdata2($start,$end);
        $this->ajaxReturn(['data',$data]);
    }
    public function indexdata1($start,$end){
        //$url = 'http://10.80.6.2:8070/byzoro.apt.com/urgencies/list/day?start='.$start.'&end='.$end.'&page=1&count=1000';
        $url = 'http://10.80.6.2:8070/byzoro.apt.com/urgencies/list/day?lastCount=5';
        //发送请求
        $data1 = request($url,false);
        $data1 = json_decode($data1,true);
        foreach ($data1['data'] as $key => &$value) {
            if($key='Time'){
                $value = date('Y-m-d H:i:s',$value);
            }
        }
        return $data1['data'];
    }
    public function indexdata2($start,$end){
        //$url = 'http://10.80.6.2:8070/byzoro.apt.com/urgencies/list/day?start='.$start.'&end='.$end.'&page=1&count=1000';
        $url = 'http://10.80.6.2:8070/byzoro.apt.com/urgencies/list/day?lastCount=5';
        //发送请求
        $data1 = request($url,false);
        $data1 = json_decode($data1,true);
        foreach ($data1['data'] as $key => &$value) {
            if($key='Time'){
                $value = date('Y-m-d H:i:s',$value);
            }
        }
        return $data1['data'];
    }
	public function assets_detail(){  
        Layout('Layout/layout');
        $this->display();
    }
    
}