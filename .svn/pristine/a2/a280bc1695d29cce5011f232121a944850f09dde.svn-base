<div class="main-content">
    <div class="breadcrumbs" id="breadcrumbs">
        <script type="text/javascript">
            try {
                ace.settings.check('breadcrumbs', 'fixed')
            } catch (e) {
            }
        </script>

        <ul class="breadcrumb">
            <li>
                攻击事件
            </li>
            <li class="active">历史信息</li>
        </ul>
        <!-- .breadcrumb -->
        <!-- #nav-search -->
    </div>
    <div class="col-sm-12">
        <div class="row">
            <div class="col-xs-12">

                <div class="formArea">
                    <form method="get" action="__URL__/his_chart">
                        <div class="floatLeft">
                            <label class="marL10">IP：</label><input type="text" name="ip" class="w100 ip">
                            <label class="marL10">选择时间：</label>
                        </div>
                        <input type="hidden" name="type" value="{$Think.session.type}">
                        <div class="input-group w300 floatLeft">
			                     <span class="input-group-addon">
			                         <i class="icon-calendar bigger-110"></i>
			                     </span>
                            <input class="form-control date-range-picker" type="text" name="date-range-picker"  data-date-format="YYYY-MM-DD"
                                   id="id-date-range-picker-1"/>
                        </div>
                        <button class="btn btn-sm btn-primary marL10"><i class="fa fa-search"></i>查询</button>
                    </form>
                    <div class="clearBoth"></div>
                </div>
<!--                <div class="buttonGroup">
                    <a href="#" class="btn btn-link" id="userAdd"><i class="icon-plus-sign bigger-120 green"></i>添加</a>|
                    <a href="#" class="btn btn-link" id="userDel"><i class="icon-remove  bigger-120 red "></i>删除</a>
                </div>-->

                <div id="container_line"
                     style="width:100%;height:300px;margin-left:0px;"></div>
            </div>
        </div>
        <div class="dataTables_paginate paging_bootstrap">
            <ul class="pagination">
                {$user_show}
            </ul>
        </div>
    </div>
</div>

<script>
    $('.ip').attr('value',getParam("ip"));
    $('.date-range-picker').attr('value',URLdecode(getParam("date-range-picker")));

    function URLdecode(sStr){
       return sStr.replace(/\+/g,' ').replace(/\%2F/g,'\/').replace(/\%20/g,'').replace(/\%3A/g,'\:'); 
    }
    function getParam(paramName)
    {
        paramValue = "";
        isFound = false;
        if (this.location.search.indexOf("?") == 0 && this.location.search.indexOf("=")>1)
        {
            arrSource = this.location.search.substring(1,this.location.search.length).split("&");
            i = 0;
            while (i < arrSource.length && !isFound)
            {
                if (arrSource[i].indexOf("=") > 0)
                {
                    if (arrSource[i].split("=")[0].toLowerCase()==paramName.toLowerCase())
                    {
                        paramValue = arrSource[i].split("=")[1];
                        isFound = true;
                    }
                }
                i++;
            }
        }
        return paramValue;
    }
    jQuery(function ($) {
        $('input[name=date-range-picker]').daterangepicker({
                    startDate: moment().subtract(1, 'days'),
                    endDate: moment(),
                    locale: {
                        applyLabel: '提交',
                        cancelLabel: '取消',
                        fromLabel: '开始时间',
                        toLabel: '结束时间',
                        weekLabel: 'W',
                        customRangeLabel: 'Custom Range',
                        daysOfWeek: ['日', '一', '二', '三', '四', '五', '六'],
                        monthNames: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'],
                        firstDay: moment.localeData()._week.dow
                    },
                    language: 'cn',
                }
        ).prev().on(ace.click_event, function () {
                    $(this).next().focus();
                });

        $(function () {
            var time_count = {$time_count};
            var time = time_count.time;
            var count = time_count.time_count;
            Highcharts.setOptions({
                global: {
                    useUTC: false
                }
            });

            // Create the chart
            Highcharts.stockChart('container_line', {
                chart: {
        
                },
                credits:{
                    enabled:false // 禁用版权信息
                },
                yAxis:{
                    opposite:false
                },
                rangeSelector: {
                    enabled: false,
                    selected: 1
                },
                navigator: {
                    enabled: false
                },
                scrollbar: {
                    enabled: false
                },
                title: {
                    text: '历史攻击趋势图'
                },

                exporting: {
                    enabled: false
                },

                series: [{
                    name: 'Random data',
                    data: (function(time,count){
                        var data = [];
                        for (var i = 0; i <= time.length - 1; i++) {
                            data.push([
                                time[i]*1000,
                                count[i]
                            ]);
                        };
                        //console.log(data)
                        return data;
                    }(time,count))/**/
                }]
            });

        });
    })
</script>