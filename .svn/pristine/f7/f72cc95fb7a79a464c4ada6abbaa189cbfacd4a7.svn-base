<div class="main-content">

    <div id="addRoom" class="popLayer" >
        <div class="breadcrumbs">
            <ul class="breadcrumb">
                <li>添加安全策略</li>
            </ul>
            <!-- .breadcrumb -->
            <span class="floatRig closePop">关闭</span>
        </div>
        <div class="col-sm-12">
            <div class="row">
                <div class="col-xs-win">
                    <!-- PAGE CONTENT BEGINS -->
                    <form action="__URL__/add_room" id="room_form" class="form-horizontal city_select"
                          method="post">
                      <div class="addplcy">    
                          
                      <div class="addplcyTop">
                      <p class="line"><label>名称：</label><input class="" type="text" placeholder="" name="r_id" pattern=""  title="" style="margin-left:12px;"></p>
                      <p><input type="checkbox">全选</p>
                      </div>
                      
                      <div class="addplcyCon">
                      <p><label><input type="checkbox">启用SQL注入防护</label>
                        <button class="btn btn-sm btn-primary marL10">高级选项</button>
                         <span>动作<select name="unitnature" class="unitnature">
                                            <option value="">允许访问</option>
                                            <option value="">禁止访问</option>
                                         </select><input type="checkbox">记录日志</span>
                      </p>
                      </div>
                      <div class="addplcyCon">
                      <p><label><input type="checkbox">启用LDAP注入防护</label>
                        <button class="btn btn-sm btn-primary marL10">高级选项</button>
                         <span>动作<select name="unitnature" class="unitnature">
                                            <option value="">允许访问</option>
                                            <option value="">禁止访问</option>
                                         </select><input type="checkbox">记录日志</span>
                      </p>
                      </div>
                      <div class="addplcyCon">
                      <p><label><input type="checkbox">启用Email注入防护</label>
                        <button class="btn btn-sm btn-primary marL10">高级选项</button>
                         <span>动作<select name="unitnature" class="unitnature">
                                            <option value="">允许访问</option>
                                            <option value="">禁止访问</option>
                                         </select><input type="checkbox">记录日志</span>
                      </p>
                      </div>
                      <div class="addplcyCon">
                      <p><label><input type="checkbox">启用Command注入防护</label>
                        <button class="btn btn-sm btn-primary marL10">高级选项</button>
                         <span>动作<select name="unitnature" class="unitnature">
                                            <option value="">允许访问</option>
                                            <option value="">禁止访问</option>
                                         </select><input type="checkbox">记录日志</span>
                      </p>
                      </div>
                      <div class="addplcyCon">
                      <p><label><input type="checkbox">启用Code注入防护</label>
                        <button class="btn btn-sm btn-primary marL10">高级选项</button>
                         <span>动作<select name="unitnature" class="unitnature">
                                            <option value="">允许访问</option>
                                            <option value="">禁止访问</option>
                                         </select><input type="checkbox">记录日志</span>
                      </p>
                      </div>
                      <div class="addplcyCon">
                      <p><label><input type="checkbox">启用Null Byte注入防护</label>
                        <button class="btn btn-sm btn-primary marL10">高级选项</button>
                         <span>动作<select name="unitnature" class="unitnature">
                                            <option value="">允许访问</option>
                                            <option value="">禁止访问</option>
                                         </select><input type="checkbox">记录日志</span>
                      </p>
                      </div>
                      <div class="addplcyCon">
                      <p><label><input type="checkbox">启用XSS注入防护</label>
                        <button class="btn btn-sm btn-primary marL10">高级选项</button>
                         <span>动作<select name="unitnature" class="unitnature">
                                            <option value="">允许访问</option>
                                            <option value="">禁止访问</option>
                                         </select><input type="checkbox">记录日志</span>
                      </p>
                      </div>
                      <div class="addplcyCon">
                      <p><label><input type="checkbox">启用CSRF注入防护</label>
                        <button class="btn btn-sm btn-primary marL10">高级选项</button>
                         <span>动作<select name="unitnature" class="unitnature">
                                            <option value="">允许访问</option>
                                            <option value="">禁止访问</option>
                                         </select><input type="checkbox">记录日志</span>
                      </p>
                      </div>
                      <div class="addplcyCon">
                      <p><label><input type="checkbox">启用溢出攻击防护</label>
                        <button class="btn btn-sm btn-primary marL10">高级选项</button>
                         <span>动作<select name="unitnature" class="unitnature">
                                            <option value="">允许访问</option>
                                            <option value="">禁止访问</option>
                                         </select><input type="checkbox">记录日志</span>
                      </p>
                      </div>
                      
                      
                      
                      
                      </div>
                      
                      
                        <div class="clearfix form-actions">
                            <div class="col-md-offset-3 col-md-6">
                                <button class="btn btn-info" type="submit" id="submit">
                                    <i class="icon-ok bigger-110"></i>
                                    提交
                                </button>
                                <button class="btn" type="reset">
                                    <i class="icon-undo bigger-110"></i>
                                    重置
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
                <!-- /.col -->
            </div>
            <!-- /.row -->
        </div>
    </div>

    <div class="breadcrumbs" id="breadcrumbs">
        <script type="text/javascript">
            try {
                ace.settings.check('breadcrumbs', 'fixed')
            } catch (e) {
            }
        </script>

        <ul class="breadcrumb">
            <li>
                Waf管理
            </li>
            <li class="active">安全策略配置</li>
        </ul>
        <!-- .breadcrumb -->

    </div>
   
   
    <div class="tabbable marL10">
        <ul class="nav nav-tabs" id="myTab">
            <li class="active">
                <a data-toggle="tab" href="__URL__/set">
                    安全策略配置
                </a>
            </li>

            <li>
                <a data-toggle="" href="__URL__/set2">
                    规则配置管理
                </a>
            </li>
        </ul>

        <div class="tab-content">
            <div id="home" class="tab-pane in active">
                <div class="col-sm-12">
                    <div class="row">
                        <div class="col-xs-12">

                            <div class="formArea marT10">
                                <form method="get" action="__URL__/suser">
                                    
                                    <div class=" floatLeft marL10">
                                        <label class="">安全策略号：</label>
                                        <input type="text" name="nature" class="w100 nature">
                                    </div>


                                    <button class="btn btn-sm btn-primary marL10"><i class="fa fa-search"></i>查询</button>

                                </form>
                            </div>


                            <div class="buttonGroup">
                                <a class="btn btn-link add_room" href="#"> <i class="icon-plus-sign bigger-120 green"></i>添加</a>
                                
                            </div>
                            

                            <div class="table-responsive" style="overflow: auto;height: 330px;">
                                <table id="table" class="table table-striped table-bordered table-hover">
                                    <thead>
                                    <tr>
                                        <th>编号</th>
                                        <th>策略名称</th>
                                        <th>子策略总数</th>
                                        <th>启用数</th>
                                        <th>禁用数</th>
                                        <th>配置状态</th>
                                        <th>操作</th>
                                       
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <volist name="data" id="data_vo">
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                    </volist>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
   
   
   
   
   </div>
   
   
   
   
        <!-- /row -->
        <div class="dataTables_paginate paging_bootstrap">
            <ul class="pagination">
                {$show}
            </ul>
        </div>
    </div>
</div><!-- /.main-content -->
<script type="text/javascript">
$(function () {
    $('#container').highcharts({
        title: {
            text: '攻击基本统计',
            x: -20 //center
        },
        subtitle: {
            text: '',
            x: -20
        },
        xAxis: {
            categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
                         'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
        },
        yAxis: {
            title: {
                text: 'Temperature (°C)'
            },
            plotLines: [{
                value: 0,
                width: 1,
                color: '#808080'
            }]
        },
        tooltip: {
            valueSuffix: '°C'
        },
        legend: {
            layout: 'vertical',
            align: 'right',
            verticalAlign: 'middle',
            borderWidth: 0
        },
        series: [{
            name: 'Tokyo',
            data: [7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6]
        }]
    });
});

</script>

<script type="text/javascript">
    $('.negroup').attr('value',getParam("negroup"));
    $('.ip').attr('value',getParam("ip"));
    $('.source').attr('value',getParam("source"));
    $('.date-range-picker').attr('value',URLdecode(getParam("date-range-picker")));

    function URLdecode(sStr){
       return sStr.replace(/\+/g,' ').replace(/\%2F/g,'\/').replace(/\%20/g,''); 
    }

    function getParam(paramName)
    {
        paramValue = "";
        isFound = false;
        if (this.location.search.indexOf("?") == 0 && this.location.search.indexOf("=")>1)
        {
            arrSource = this.location.search.substring(1,this.location.search.length).split("&");
            i = 0;
            while (i < arrSource.length && !isFound)
            {
                if (arrSource[i].indexOf("=") > 0)
                {
                    if (arrSource[i].split("=")[0].toLowerCase()==paramName.toLowerCase())
                    {
                        paramValue = arrSource[i].split("=")[1];
                        isFound = true;
                    }
                }
                i++;
            }
        }
        return paramValue;
    }

    $(".more").click(function () {
        var div = $(".moreSelect");
        if (div.css("display") === "none") {
            div.show();
            $('.more').html('收起')
        } else {
            div.hide();
            $('.more').html('更多条件')
        }
        return false;
    })

</script>
<script type="text/javascript">

	    $(".add_room").css("cursor", "pointer").click(function () {
        $("#addRoom").show();
        $("#fade").show();
    });
    $(".closePop").css("cursor", "pointer").click(function () {
        $("#addRoom").hide();
        $("#delUser").hide();
        $("#editeRoom").hide();
        $("#fade").hide();
    });

    jQuery(function ($) {
        $('input[name=date-range-picker]').daterangepicker({
                    locale : {
                        applyLabel: '提交',
                        cancelLabel: '取消',
                        fromLabel: '开始时间',
                        toLabel: '结束时间',
                        weekLabel: 'W',
                        customRangeLabel: 'Custom Range',
                        daysOfWeek: ['日', '一', '二', '三', '四', '五','六'],
                        monthNames: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'],
                        firstDay: moment.localeData()._week.dow
                    },
                    language: 'cn',}
        ).prev().on(ace.click_event, function () {
                    $(this).next().focus();
                });

    })
</script>
