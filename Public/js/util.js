var _Arrow={left:"&#9668;",right:"&#9658;",top:"&#9650;",bottom:"&#9660;"};var SPACE_CHAR="&#xA0;";var ESCAPE_CHAR_TAB="&#xA0;&#xA0;&#xA0;&#xA0;";if(isff){Event.prototype.__defineSetter__("cancelBubble",function(a){return a?this.stopPropagation():a;});Event.prototype.__defineGetter__("srcElement",function(){var a=this.target;while(a&&a.nodeType!=1){a=a.parentNode;}return a;});Event.prototype.__defineSetter__("returnValue",function(a){return a?a:this.preventDefault();});HTMLElement.prototype.__defineGetter__("innerText",function(){var b=[];var a=this.childNodes;var d;for(var c=0;c<a.length;c++){d=a[c];if(d.nodeType==1){b.push(d.tagName.toLowerCase()=="br"?"\n":d.innerText);}else{if(d.nodeType==3){b.push(d.nodeValue);}}}return b&&b.length>0?b.join(""):"";});HTMLElement.prototype.__defineSetter__("innerText",function(a){this.textContent=a;});}if(!Object.keys){Object.keys=(function(){var c=Object.prototype.hasOwnProperty,d=!({toString:null}).propertyIsEnumerable("toString"),b=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],a=b.length;return function(g){if(typeof g!=="object"&&typeof g!=="function"||g===null){throw new TypeError("Object.keys called on non-object");}var e=[];for(var h in g){if(c.call(g,h)){e.push(h);}}if(d){for(var f=0;f<a;f++){if(c.call(g,b[f])){e.push(b[f]);}}}return e;};})();}if(!Function.prototype.bind){Function.prototype.bind=function(a){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");}var e=Array.prototype.slice.call(arguments,1),d=this,b=function(){},c=function(){return d.apply(this instanceof b&&a?this:a,e.concat(Array.prototype.slice.call(arguments)));};b.prototype=this.prototype;c.prototype=new b();return c;};}Function.prototype.bind2=function(e){if(!window.__objs){window.__objs=[];window.__funs=[];}var a=this;var d=e.__objId;if(!d){__objs[d=e.__objId=__objs.length]=e;}var f=a.__funId;if(!f){__funs[f=a.__funId=__funs.length]=a;}if(!e.__closures){e.__closures=[];}var g=e.__closures[f];if(g){return g;}e=null;a=null;var c=arguments.length>1;var b=arguments;return __objs[d].__closures[f]=function(){return __funs[f].apply(__objs[d],c?Array.prototype.slice.call(b,1):arguments);};};Function.prototype.bind2EventListener=function(b){var a=this;return function(c){a.call(b,c||window.event);};};String.prototype.equalsIgnoreCase=function(a){a=a==null?"":a;return this.toUpperCase()===a.toUpperCase();};String.prototype.compareTo=function(c){var b=this.toString();var a=c.toString();if(b===a){return 0;}else{if(b>a){return 1;}else{return -1;}}};String.prototype.compareToIgnoreCase=function(c){var b=this.toUpperCase();var a=c.toUpperCase();if(b===a){return 0;}else{if(b>a){return 1;}else{return -1;}}};String.prototype.startsWith=function(a){return this.substring(0,a.length)==a;};String.prototype.endsWith=function(a){return this.substring(this.length-a.length)==a;};String.prototype.concat=function(a){return new String(this.toString()+a);};String.prototype.toCharArray=function(){var b=new Array();for(var a=0;a<this.length;a++){b[a]=this.charAt(a);}return b;};String.prototype.ensureNotStartWith=function(a){var b=this.toString();if(!b||(len=this.length)==0){return b;}if(a.length==0||a.length>this.length){return b;}else{if(this.startsWith(a)){return this.substring(a.length);}else{return b;}}};String.prototype.ensureStartWith=function(a){var b=this.toString();if(!a||(a.length==0)){return b;}if(this.startsWith(a)){return b;}return a+b;};String.prototype.ensureNotEndWith=function(b){var a;var c=this.toString();if(!c||(a=this.length)==0){return c;}if(b.length==0){return c;}else{while((a!=0)&&(b.indexOf(this.charAt(a-1))!=-1)){a--;}}return this.substring(0,a);};String.prototype.ensureEndWith=function(a){var b=this.toString();if(!a||(a.length===0)){return b;}return b.endsWith(a)?b:(b+a);};String.prototype.replaceAll=function(a,b){return this.replace(new RegExp(a,"gm"),b);};if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"");};}String.prototype.trimStart=function(){return this.replace(/^\s+/,"");};String.prototype.trimEnd=function(){return this.replace(/\s+$/,"");};String.prototype.toArray=function(b){var a=this.trim();if(!b){b=",";}if(a<" "){return new Array();}else{return a.split(b);}};String.prototype.toHTML=function(){return this.toString().replace(/\&/g,"&amp;").replace(/\>/g,"&gt;").replace(/\</g,"&lt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#39;");};String.prototype.unHTML=function(){return this.toString().replace(/\&gt;/g,">").replace(/\&lt;/g,"<").replace(/\&quot;/g,'"').replace(/\&#39;/g,"'").replace(/\&amp;/g,"&");};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(b){for(var a=0;a<this.length;a++){if(this[a]==b){return a;}}return -1;};}Array.prototype.putAll=function(b){if(b){for(var c=0,a=b.length;c<a;c++){this.push(b[c]);}}};Array.prototype.insertAt=function(b,a){this.splice(a,0,b);};Array.prototype.removeAt=function(a){this.splice(a,1);};Array.prototype.clear=function(){this.splice(0,this.length);};Array.prototype.compareToStr=function(a){if(this.length==a.length){for(var c=0;c<this.length;c++){var b=a[c];if(this.indexOfIgnoreCase(b)==-1){return false;}}return true;}return false;};Array.prototype.indexOfIgnoreCase=function(c){var b=c.toUpperCase();for(var a=0;a<this.length;a++){if(this[a].toUpperCase()==b){return a;}}return -1;};Array.prototype.remove=function(b){var a=this.indexOf(b);if(a>=0){this.splice(a,1);return true;}return false;};if(!Array.prototype.forEach){Array.prototype.forEach=function(c){if(this===void 0||this===null){throw new TypeError();}var e=Object(this);var a=e.length>>>0;if(typeof c!=="function"){throw new TypeError();}var b=arguments.length>=2?arguments[1]:void 0;for(var d=0;d<a;d++){if(d in e){c.call(b,e[d],d,e);}}};}if(!Array.prototype.every){Array.prototype.every=function(c){if(this===void 0||this===null){throw new TypeError();}var e=Object(this);var a=e.length>>>0;if(typeof c!=="function"){throw new TypeError();}var b=arguments.length>=2?arguments[1]:void 0;for(var d=0;d<a;d++){if(d in e){if(!c.call(b,e[d],d,e)){return false;}}}return true;};}Number.prototype.equals=function(a){return this.toString()==a.toString();};Number.prototype.compareTo=function(a){return this-a;};Number.prototype.toRound=function(b){var a=Math.pow(10,b||0);return Math.round(this*a)/a;};Number.prototype.toCeil=function(b){var a=Math.pow(10,b||0);return Math.ceil(this*a)/a;};Number.toHexString=function(a){return a.toString(16);};Number.toBinaryString=function(a){return a.toString(2);};Date.prototype.hashCode=function(){var b=this.getTime();var c=Number.toHexString(b);var d=0;if(c.length>8){d=parseInt(c.substring(0,c.length-8),16);}var a=b&4294967295;return a^d;};Date.prototype.compareTo=function(a){return(this.getTime()-a.getTime())&4294967295;};CallBackFunc.prototype.invoke=function(){if(this.clsinstance){return this.method.apply(this.clsinstance,arguments);}else{if(this.method){return this.method.apply(null,arguments);}else{return eval(this.exestr);}}};function doCallBack(cb){if(!cb){return true;}var args=null;if(arguments.length>1){args=new Array();for(var i=1;i<arguments.length;i++){args.push(arguments[i]);}}try{if(typeof(cb.invoke)=="function"){if(args){return cb.invoke.apply(cb,args);}else{return cb.invoke.call(cb);}}else{if(typeof(cb)=="function"){if(args){return cb.apply(null,args);}else{return cb();}}else{return eval(cb);}}}catch(e){throwError(e.description||e.message);}}function callFuncInWnd_Eval(win,funcname,defresult){try{win=win?win:window;var func=win[funcname];if(!func){return defresult;}var args=new Array();if(arguments.length>3){for(var i=3;i<arguments.length;i++){var arg=arguments[i];if(typeof(arg)=="string"){arg="'"+arg+"'";}args.push(arg);}}var res=win.eval(funcname+"("+args.join(",")+")");if(typeof(res)=="undefined"){return defresult;}return res;}catch(e){return defresult;}}function callFuncInWnd(c,a){c=c?c:window;var b=c[a];if(!b){return;}return _callFuncWithArgs(b,arguments,2);}function _callFuncWithArgs(f,c,b){if(c.length<b){return f();}try{var a=new Array();for(var d=b;d<c.length;d++){a.push(c[d]);}return f.apply(null,a);}catch(g){throwError(g.description||g.message);}}function callFuncInWnd_Async(e,d,a){d=d?d:window;var c=d[a];if(c){return _callFuncWithArgs(c,arguments,3);}var b=arguments;sys.lib.includeAsync(e,d,function(){_callFuncWithArgs(callFuncInWnd,b,3);},_showWaitDialog_whileLoadingjs);}function attacheEvent4TopIframes(c,b,a){if(typeof(a)!="function"){return;}attacheEvent4Iframes(c,getRootWindow().document,b,a);}function attacheEvent4Iframes(a,l,j,d){if(a=="add"){addEvent(l,j,d,false);}else{removeEvent(l,j,d,false);}var k,g,b,c,m;var h=l.getElementsByTagName("iframe");for(var f=0;h&&f<h.length;f++){try{k=h[f];m=k.parentNode;if(k.id&&k.id.indexOf("SAN_BACKGROUND_IFRAME_ID")>=0){continue;}if(k.style.visibility=="hidden"||k.style.display=="none"||(m&&m.style.visibility=="hidden")||(m&&m.style.display=="none")){continue;}g=k.contentWindow;b=g.document;c=b.body;if(!g||!b||!c){continue;}attacheEvent4Iframes(a,b,j,d);}catch(j){}}attacheEvent4Frames(a,l,j,d);}function attacheEvent4Frames(a,l,j,d){var k,h,b,c,m;var g=l.getElementsByTagName("frame");for(var f=0;f<g.length;f++){try{k=g[f];m=k.parentNode;if(k.style.visibility=="hidden"||k.style.display=="none"){continue;}h=k.contentWindow;b=h.document;c=b.body;if(!h||!b||!c){continue;}attacheEvent4Iframes(a,b,j,d);}catch(j){}}}CallBackFunc.doCallBack=doCallBack;function CallBackFuncs(){this.listeners=new Array();}CallBackFuncs.prototype.add=function(a){this.listeners.push(a);};CallBackFuncs.prototype.remove=function(a){this.listeners.remove(a);};CallBackFuncs.prototype.invoke=function(){if(this.listeners.length==0){return;}var a=new Array();a.push(null);for(var b=0;(arguments)&&(b<arguments.length);b++){a.push(arguments[b]);}for(var b=0;b<this.listeners.length;b++){a[0]=this.listeners[b];doCallBack.apply(null,a);}};CallBackFuncs.prototype.clear=function(){return this.listeners.clear();};CallBackFuncs.prototype.size=function(){return this.listeners.length;};CallBackFuncs.prototype.dispose=function(){this.listeners=null;};function getHtmlBody(b){if(!b){return b;}var a=b.indexOf("<body");if(a>-1){a=b.indexOf(">",a);var c=b.lastIndexOf("</body>");b=b.substr(a+1,c-a-1);}if(isMSIE){return b;}return b.replace(/(&nbsp;)/g,SPACE_CHAR);}function getScriptBody(b){if(!b){return b;}var a=b.indexOf("<script");if(a>-1){a=b.indexOf(">",a);var c=b.lastIndexOf("<\/script>");b=b.substr(a+1,c-a-1);return b;}else{return null;}}function setInnerHTML(obj,html){var start="<script";var end="<\/script>";var i1=html.indexOf(start,0);var arr=[];var _body,_script;while(i1!=-1){var i2=html.indexOf(end,i1);var i3=html.indexOf(">",i1);var str=html.substring(i3+1,i2);if(str!=""){arr.push(str);}i1=html.indexOf(start,i2);}obj.innerHTML=getHtmlBody(html);eval(arr.join("\r\n"));}function getActiveTdElement(){if(isie){var a=document.activeElement;if(!"TD".equalsIgnoreCase(a.tagName)){a=a.parentElement;if(a&&!"TD".equalsIgnoreCase(a.tagName)){a=a.parentElement;if(a&&!"TD".equalsIgnoreCase(a.tagName)){return null;}}}if(a){return a;}}return null;}function getRealLeft(b){var a=b.offsetLeft-b.scrollLeft;b=b.offsetParent;while(b&&b.tagName!="BODY"){a+=b.offsetLeft-b.scrollLeft+b.clientLeft;b=b.offsetParent;}return a;}function getRealTop(b){var a=b.offsetTop-b.scrollTop;b=b.offsetParent;while(b&&!"BODY".equalsIgnoreCase(b.tagName)){a+=b.offsetTop-b.scrollTop+b.clientTop;b=b.offsetParent;}return a;}function getDomTop(e,a,c){var d=e;if(!a){return getDomOffsetTop(d);}var f=d.offsetParent;var b=getDomOffsetTop(d,c);while(f!=null&&f!=a){b+=getDomOffsetTop(f,c);f=f.offsetParent;}return b;}function getDomOffsetTop(b,a){return b.offsetTop-(a?b.scrollTop:0)+b.clientTop;}function getDomLeft(e,a,c){var d=e;if(!a){return getDomOffsetLeft(d);}var f=d.offsetParent;var b=getDomOffsetLeft(d,c);while(f!=null&&f!=a){b+=getDomOffsetLeft(f,c);f=f.offsetParent;}return b;}function getDomOffsetLeft(b,a){return b.offsetLeft-(a?b.scrollLeft:0)+b.clientLeft;}function getAbsScrollPosition(e,a){if(!e){return;}var d=a?a:e.ownerDocument;var c=e.scrollLeft;var b=e.scrollTop;e=e.offsetParent;while(e&&e!=d){c+=e.scrollLeft;b+=e.scrollTop;e=e.offsetParent;}return{x:c,y:b};}function getAbsPosition(f,c,a){var e=c.ownerDocument||f.document,b=c.getBoundingClientRect(),d=null;if(!a){a=e.documentElement;d={left:0,top:0};}else{d=a.getBoundingClientRect();}return{x:b["left"]-d["left"]+a.scrollLeft-(a.clientLeft||0),y:b["top"]-d["top"]+a.scrollTop-(a.clientTop||0)};}function appendTable(doc,pe){var obj=doc.createElement("table");with(obj){border=0;cellPadding=0;cellSpacing=0;}return pe?pe.appendChild(obj):obj;}function appendTbody(c,a){var b=c.createElement("tbody");return a?a.appendChild(b):b;}function appendRow(c,a){var b=c.createElement("tr");return a?a.appendChild(b):b;}function appendCell(b,c){var a=b.createElement("td");return c?c.appendChild(a):a;}function maxDomSizeOnResize(a){var b=null;if(typeof(a)=="string"){b=a;}else{b=a.id;}maxDomSize(b);if(window.attachEvent){window.attachEvent("onresize",function(){setTimeout_killExistFirst("maxDomSize('"+b+"');",200,this,b);});}else{window.addEventListener("resize",function(){setTimeout_killExistFirst("maxDomSize('"+b+"');",200,this,b);},false);}}function maxDomSize(c){var b=document.getElementById(c);var a=b.parentNode;if(a.clientWidth==0||a.clientHeight==0){return;}if(b.width==null){b.style.width=a.clientWidth;b.style.height=a.clientHeight;}else{b.width=a.clientWidth;b.height=a.clientHeight;}}function setTextContent(b,c,a){if(!b){return;}c=typeof(c)=="string"||typeof(c)=="number"?c:(a==false?"":" ");if(b.nodeType==3){b.data=c;}else{if(isie){b.style.display="none";b.innerText=c;b.style.display="";}else{b.textContent=c;}}}function getTextContent(d){if(!d){return null;}var b=d.nodeType;if(b===1||b===9||b===11){if(typeof d.textContent==="string"){return d.textContent;}else{var a=[];for(var c=d.firstChild;c;c=c.nextSibling){a.push(getTextContent(c));}return a.join("");}}else{if(b===3||b===4){return d.nodeValue;}}return"";}function getTextContent4Xml(a){if(!a){return null;}return(isie?(a.text||a.nodeTypedValue||a.textContent):a.textContent)||"";}(function(f,t){var a="\r\n",v="\t",e=" ",q="=",n="'",r="<",m="</",c=">",s="/>",d="<![CDATA[",p="]]>";function h(w){return a+(new Array((w||0)+1).join(v));}function l(z,y,w){var x=h(w||0);z.push(x,d,a,y,x,p);}function j(y,w,x){y.push(e,w,q,n,x.toHTML(),n);}function b(E,x,D,z,I){if(!E){E=[];}var w=h(D);E.push(w,r,x);if(z){for(var B=0,F=null,C=z.length;B<C;B++){F=z[B];j(E,F["name"],F["value"]);}}E.push(c);var A=E.length,H=0;if(I){var y=I["func"],G=I["args"]||[];if(typeof(y)==="function"){if(G[0]!==E){G.unshift(E);}y.apply(I["scope"],G);}H=E.length-A;if(!H&&I["fulltag"]){H=1;}}if(!H){E.pop();E.push(s);return E;}if(H!=1){E.push(w);}E.push(m,x,c);return E;}var u=/\r|\n|\t/g;function i(B,A,w,y){var x=A.firstChild,z=w&&x&&(x.nextSibling!==null);while(x){o(B,x,w,y,z);x=x.nextSibling;}}function o(B,A,y,z,x){if(typeof(z)==="function"&&z(A,x)===false){return;}switch(A.nodeType){case 1:b(B,A.tagName.toLowerCase(),y,A.attributes,{func:i,args:[B,A,y+1,z],scope:this});break;case 3:var w=A.nodeValue.replace(u,"");if(w){if(x===true){B.push(h(y));}B.push(w.toHTML());}break;}}function g(y,w){var x=[];i(x,y,0,w);return x.join("");}function k(y,w){var x=[];o(x,y,0,w);return x.join("");}f[t]={getNodeHTML:k,getChildHTML:g};})(window,"DomUtil");function clearAllContent(b,a){var c=b.firstChild,d=null;if(typeof(a)==="function"){while(d=c){c=c.nextSibling;if(a(d,b)!==true){b.removeChild(d);}}}else{while(d=c){c=c.nextSibling;b.removeChild(d);}}return b;}function getChildNodes(g,c){var f=g.childNodes,e=null,b=0;for(var d=0,a=f.length;d<a;d++){e=f[d];if(e.nodeType!=3||e.nodeValue.indexOf("\n")!=0){if(b++==c){return e;}}}}function getCDATASectionValue(d){var c=d.childNodes.length;if(c==0){return d.nodeName=="#cdata-section"?d.nodeValue:"";}var b;var e=null;for(var a=0;a<d.childNodes.length;a++){b=d.childNodes[a];if(b.nodeName=="#cdata-section"){e=(e==null?"":e)+b.nodeValue;}else{if(e!=null){break;}}}return e==null?"":e;}function getChildDomByAttrib(b,g,f,d){if(b==null||f==null){return null;}var e=b.childNodes;var a=e.length;var h;for(var c=0;c<a;c++){h=e[c];if(h.nodeType!==1){continue;}if(f.equalsIgnoreCase(h[g])||(f.equalsIgnoreCase(h.getAttribute(g)))){return h;}if(d){h=getChildDomByAttrib(h,g,f,d);if(h!=null){return h;}}}return null;}function getChildDomByAttribWithIndex(b,d,h,e){if(b==null){return null;}if(!e){e=0;}var g=b.childNodes;var f=g.length;var a;var j=-1;for(var c=0;c<f;c++){a=g[c];if(a.nodeType!==1){continue;}if(h.equalsIgnoreCase(a[d])||(h.equalsIgnoreCase(a.getAttribute(d)))){j++;if(j==e){return a;}}}return null;}function setHtmlContent(b,f){if(!b){return;}var c=getWndOfDom(b);var h=c.document;var g=/<script.*?>[\s\S]*?<\/script>/gi;var a=f.match(g);f=f.replace(g,"");if(isMSIE){f="<span style=display:none>MSIE</span>"+f;b.innerHTML=f;b.removeChild(b.firstChild);}else{var k=b.nextSibling;var j=b.parentNode;if(j.nodeType!=1){return;}j.removeChild(b);var g=/<style.*?>[\s\S]*?<\/style>/gi;var d=f.match(g);if(d&&d.length>0){var e=h.getElementsByTagName("head")[0];var i=h.getElementById("style4InnerHtml");if(!i){i=e.appendChild(h.createElement("style"));i.id="style4InnerHtml";}if(i.parentNode!=e){e.appendChild(i);}clearAllContent(i);i.innerHTML=_styles2String4HtmlContent(d);f=f.replace(g,"");}b.innerHTML=f.replace(/(&nbsp;)/g,SPACE_CHAR);k&&k.nodeType==1?j.insertBefore(b,k):j.appendChild(b);}exeDomScriptJs(b,a,c);}function exeDomScriptJs(c,b,d){var a,k,j=d.document;for(var f=0;b&&f<b.length;f++){a=b[f];k=a.indexOf(">");if(k==-1){continue;}if(a.substring(0,k+1).indexOf("src=")!=-1){_sysIncludeJs4HtmlContent(a);}else{if(a.indexOf("/*rptclientjs*/")>-1){if(isie&&ieVersion<=8){var h="";a.replace(/<script[^>]*>([\s\S]*?)<\/script>/gi,function(){h+=arguments[1]+"\n";});var g=j.createElement("script");g.setAttribute("type","text/javascript");g.text=h;c.appendChild(g);}else{var e=j.createElement("div");e.innerHTML=a;c.appendChild(e.firstChild);e=null;}continue;}a=a.substring(k+1,a.length-"<\/script>".length);execJavaScript(a,d);}}}function setDivPos(div,x,y){if(isie){with(div.style){pixelTop=y;pixelLeft=x;}}else{with(div.style){top=y+"px";left=x+"px";}}}function addScript(e,f,a){var b=e.getElementsByTagName("head");var g=b&&b.length>0;if(g){if(findScript(e,f)!=-1){return;}var d=b[0];var c=e.createElement("script");if(a){if(isMSIE&&ieVersion<9){c.onreadystatechange=function(){var h=c.readyState;if(h=="loaded"||h=="complete"){c.onreadystatechange=null;a();}};c.src=f;d.appendChild(c);}else{c.onload=a;d.appendChild(c);c.src=f;}}else{d.appendChild(c);c.src=f;}}}function addStyle(e,b,g){var a=e.getElementsByTagName("head");var f=a&&a.length>0;if(f){if(findStyle(e,b)!=-1){return;}var d=a[0];var c=d.appendChild(e.createElement("link"));c.rel="stylesheet";c.type="text/css";if(typeof(g)==="function"){c.onload=g;}c.href=b;}}function addStyleSheet(c,i,d){if(!d){d=window;}var g=d.document,h=g.getElementById(i),b=null;if(!h){var a=g.getElementsByTagName("head")[0];h=g.createElement("style");h.setAttribute("type","text/css");if(i){h.setAttribute("id",i);}a.appendChild(h);}if(isie){b=h.styleSheet;b.cssText+=c;}else{try{h.appendChild(g.createTextNode(c));}catch(f){h.cssText+=c;}b=h.styleSheet?h.styleSheet:(h.sheet||g.styleSheets[g.styleSheets.length-1]);}return b;}function findScript(d,e){var c=d.getElementsByTagName("script");if(!c){return;}var b=c.length;for(var a=0;a<b;a++){if(c[a].src.indexOf(e)!=-1){return a;}}return -1;}function findStyle(e,a){var c=e.getElementsByTagName("link");if(!c){return;}var d=c.length;for(var b=0;b<d;b++){if(c[b].href.indexOf(a)!=-1){return b;}}return -1;}function _styles2String4HtmlContent(d){if(!d||d.length<1){return"";}var a;var c;for(var b=0;b<d.length;b++){c=d[b];if(!a){a=[];}a.push(c.substring(c.indexOf(">")+1,c.indexOf("</style>")));}return a.join("\n");}function _sysIncludeJs4HtmlContent(d){if(!d){return;}var e=/src=("|')([^\"]*?.js)("|')/gi;var c=d.match(e);var b;for(var a=0;c&&a<c.length;a++){b=c[a];sys.lib.include(b.substring(5,b.length-1));}}function getChildNodeAt(d,c,b){if(!d){return null;}b=parseInt(b)||0;var f=d.firstChild,a=-1;if(!c){c=false;}while(f){var e=f.tagName;if(e&&(!c||e.equalsIgnoreCase(c))){a++;if(a===b){return f;}}f=f.nextSibling;}return null;}function getActiveElement(b,a){if(!b){b=document;}if(!a){a=window.event;}return b.activeElement?b.activeElement:a.explicitOriginalTarget;}function domIsParent(d,e){if(!e||!d||e==d){return false;}var b=e.parentNode;var a=d.ownerDocument.body;while(b&&b!=d&&b!=a){b=b.parentNode;}return b==d;}function getFirstChild(b){if(!b){return null;}var a=b.firstChild;if(!a){return null;}if(a.nodeType==1){return a;}return getNextElementSibling(a);}function getDomChildNodes(e){var a=new Array();if(!e){return a;}var c=e.childNodes;for(var b=0;b<c.length;b++){var d=c[b];if(d.nodeType!=1){continue;}a.push(d);}return a;}function getWndOfDom(a){return a&&a.ownerDocument?(isie?a.ownerDocument.parentWindow:a.ownerDocument.defaultView):window;}function getWndOfDoc(a){return a?(isie?a.parentWindow:a.defaultView):window;}function getCurrentStyle(c,d){var b=null;if(c.currentStyle){d=d.replace(/-[a-z]/g,function(e){return e.charAt(1).toUpperCase();});b=c.currentStyle[d];}else{if(window.getComputedStyle){var a=getWndOfDom(c).getComputedStyle(c,"");if(a){d=d.replace(/[A-Z]/g,"-$&").toLowerCase();b=a.getPropertyValue(d);}}}return b;}function _getBorderSize(c,a){var b=["borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth"];return(parseInt(getCurrentStyle(c,b[a]))||0)+(parseInt(getCurrentStyle(c,b[a+2]))||0);}function _getPaddingSize(c,a){var b=["paddingTop","paddingRight","paddingBottom","paddingLeft"];return(parseInt(getCurrentStyle(c,b[a]))||0)+(parseInt(getCurrentStyle(c,b[a+2]))||0);}function execDomEvent(c,g){try{if(c[g]){c[g]();}else{var f=c.ownerDocument,b=f.parentWindow||f.defaultView;var a=f.createEvent("MouseEvents");a.initMouseEvent(g,true,true,b);c.dispatchEvent(a);}}catch(d){}}function getRowColFromName(d){var b=-1;var a=d.length;var e=0;for(;e<a;e++){var g=d.charCodeAt(e);if(g<=57&&g>=48){break;}b=(b+1)*26+(g-65);}var f=e-1<a?parseInt(d.substring(e))-1:-1;return[f,b];}function getRowFromName(a){return getRowColFromName(a)[0];}function getColFromName(a){return getRowColFromName(a)[1];}function getTarget(a,b){a=a?a:window;b=b?b:a.event;if(!b){return null;}return b.srcElement?b.srcElement:b.target;}function _getMouseEventTarget(a){return a.srcElement?a.srcElement:a.target;}function getKeyCode(b,a){a=a&&typeof(a)=="object"?a:window;if(!b){b=a.event;}return b.keyCode;}function getTargetId(b,a){a=a&&typeof(a)=="object"?a:window;if(!b){b=a.event;}return b.target?b.target.id:b.srcElement.id;}function getCursorPosition(b,a){a=a&&typeof(a)=="object"?a:window;if(!b){b=a.event;}return{x:b.clientX,y:b.clientY};}function moveCursorTo(c,d){if(typeof(c)!="object"){return;}var a=0;var b=c.createTextRange();if(d&&typeof(d)=="function"){a=d(b);}b.moveStart("character",typeof(a)=="number"?a:0);b.collapse(true);b.select();return b;}function setFocus(a){if(typeof(a)=="string"){a=document.getElementById(a);}if(typeof(a)=="object"){try{a.focus();}catch(b){}}}function onFocus(b,a){if(b&&typeof(b)=="string"&&b.lenght>0){b=document.getElementById(b);}if(a&&typeof(a)=="string"&&a.lenght>0){a=document.getElementById(a);}if(typeof(b)!="object"||typeof(a)!="object"){return;}b.onkeydown=function(c){if(!c){c=getWndOfDom(b).event;}if(c.keyCode==13){try{a.focus();}catch(c){}}};}function onEnter(id,func){if(id&&typeof(id)=="string"&&id.length>0){id=document.getElementById(id);}if(typeof(id)!="object"){return;}id.onkeydown=function(e){if(!e){e=getWndOfDom(id).event;}if(e.keyCode==13){if(typeof(func)=="function"){func();}else{if(typeof(func)=="string"){eval(func);}}}};}var HEXCHAR=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"];function convert2Regex(h){if(typeof(h)!="string"||h==null||h.length==0){return null;}var b=new Array();var e=h.split(";");for(var a=0;a<e.length;a++){var d=e[a];if(a>0){b.push("|");}b.push("^");for(var f=0,g=d.length;f<g;f++){var j=d.charAt(f);switch(j){case"*":b.push(".*");break;case"?":b.push(".");break;case"(":case")":case"[":case"]":case"$":case"^":case".":case"{":case"}":case"|":case"\\":b.push("\\");b.push(j);break;default:b.push(j);break;}}b.push("$");}return b.join("");}function str2Text(e){if(e==null||e.length==0){return e;}var a=[];var d,b=0;for(d=0,len=e.length;d<len;d++){var g=e.charAt(d);var f=e.charCodeAt(d);switch(g){case"\t":a.push("\\");a.push("t");break;case"\r":a.push("\\");a.push("r");break;case"\n":a.push("\\");a.push("n");break;case"\\":a.push("\\");a.push("\\");break;default:if((f>=1&&f<=8)||(f>=14&&f<=32)||(f==11)||(g==12)){a.push("\\");a.push("u");a.push(new String(f/16).charAt(0));a.push(HEXCHAR[f%16]);}else{a.push(g);}}}return a.join("");}function text2Str(f){if((f==null)||(f.indexOf("\\")==-1)){return f;}var l=[];for(var e=0,j=f.length;e<j;){if(e==f.length){break;}var k=f.charAt(e);if(k=="\\"){if(e+1==f.length){return l;}var d=f.charAt(e+1);switch(d){case"\\":l.push("\\");break;case"r":l.push("\r");break;case"n":l.push("\n");break;case"t":l.push("\t");break;case"u":if(e+3<f.length){var b=f.charAt(e+2);var a=f.charAt(e+3);var h=hexToInt(b);var g=hexToInt(a);if((g!=-1)&&(h!=-1)){l.push(String.fromCharCode(h*16+g));}e+=2;}}e+=2;}else{l.push(k);e+=1;}}return l.join("");}function hexToInt(c){var b=-1;c=c.toUpperCase();for(var a=0;a<HEXCHAR.length;a++){if(HEXCHAR[a]==c){b=a;break;}}return b;}function quotedStr(c,a){if(c==null){return null;}if(a==null){a='"';}var b=c.indexOf(a);if(b==-1){return a+c+a;}var d=0;var e=a;while(b!=-1){e=e+c.substring(d,b)+a+a;d=b+1;b=c.indexOf(a,d);}e=e+c.substring(d)+a;return e;}function extractQuotedStr(b,a,c){this.s=b;this.quote=a;this.startIndex=c;this.value="";this.endIndex=-1;this.getValue=function(){if((this.s==null)||(this.s.length<=this.startIndex)||this.s.charAt(this.startIndex)!=this.quote){this.endIndex=-1;this.value=this.s;return this.value;}var e=this.startIndex+1;var d=this.s.indexOf(this.quote,e);while(d!=-1){if((this.s.length>d+1)&&(this.s.charAt(d+1)==this.quote)){d++;this.value=this.value+this.s.substring(e,d);}else{this.value=this.value+this.s.substring(e,d);break;}e=d+1;d=this.s.indexOf(this.quote,e);}d=d==-1?this.startIndex+1:d;this.endIndex=(e==-1)?-1:d+1;return this.value;};this.getEndIndex=function(){return this.endIndex;};this.toString=function(){return this.getValue();};return this;}function isChineseChar(a){return(a>=13312&&a<40959)||(a>=63744);}function isStrEmpty(a){return a==undefined||a==null||a==""||a.trim().length==0;}function ensureStrNotEmpty(a){return(a==undefined||a==null)?"":a;}function validateFileName(d){if(d==null){return false;}var e=new RegExp("^[^/\\\\<>*?:\"|~$&'=!,\t;]+$");var a=e.test(d)&&d.length<255;if(a){for(var b=0;b<d.length;b++){var f=d.charAt(b);if(f!="."&&f!="\n"&&f!="\r"&&f!="\t"&&f!=" "){return true;}}}else{return false;}}function seperateStr(g,f){if(isStrEmpty(g)){return g;}var b=[""];var c=0;for(var d=0,a=g.length;d<a;d++){var e=g.charAt(d);if(e==f){if(d+1<a&&g.charAt(d+1)==f){b[c]+=e;d++;}else{b[++c]="";}}else{b[c]+=e;}}return b;}ESCAPE_REGEX=/^[_0-9a-zA-Z@.\*\/\+\$\-]+$/ig;function escapeURIComponent(a){if(a==null){return"";}if(typeof(a)!="string"){a+="";}if(a.length==0){return"";}ESCAPE_REGEX.lastIndex=0;if(ESCAPE_REGEX.test(a)){return a;}else{return encodeURIComponent(escape(a));}}function unescapeURIComponent(a){return a&&a.length>0?unescape(decodeURIComponent(a)):"";}function object2String(e,f,d){if(!e||typeof(e)!="object"){return null;}if(typeof(d)!="boolean"){d=false;}var c;var a=[];for(var b in e){c=e[b];if(!c||(!f&&typeof(c)=="function")){continue;}a.push(b+":"+(d?"'":'"')+c+(d?"'":'"'));}return"{"+a.join(",")+"}";}function isValidSymbol(a){if(a==null||a.length==0||a.length>100){return false;}var b=/^[a-z]+[a-z_0-9\$]*$/i;return b.test(a);}function extractFileExt(b){var a=b.lastIndexOf(".");return a!=-1?b.substring(a):"";}function extractFileName(c,b){var d=c.lastIndexOf("\\");if(d==-1){d=c.lastIndexOf("/");}d+=1;var a;if(b){a=c.length;}else{a=c.lastIndexOf(".");if(a==-1){a=c.length;}}return c.substring(d,a);}function isAlien(b){return !isFunction(b)&&/\{\s*\[native code\]\s*\}/.test(String(b));}function isArray(b){return b&&(b instanceof Array||b.constructor==Array||(typeof(b.pop)=="function"&&typeof(b.push)=="function"&&typeof(b.splice)=="function"));}function isArrayLike(b){if(isString(b)){return false;}if(isArray(b)){return true;}if(typeof(b)!="undefined"&&b&&isNumber(b.length)&&isFinite(b.length)){return true;}return false;}function isEmpty(c){var b,a;if(isObject(c)){for(b in c){a=c[b];if(isUndefined(a)&&isFunction(a)){return false;}}}return true;}function isNull(b){return typeof(b)=="object"&&!b;}function hasValue(b,a){if(b==undefined||b==null){return false;}if(!a&&typeof(b)=="string"){if(b.trim().length==0){return false;}}return true;}function isFunction(b){return(b instanceof Function||typeof(b)=="function");}function isBoolean(b){return(b instanceof Boolean||typeof(b)=="boolean");}function isNumber(b){return(b instanceof Number||typeof(b)=="number");}function isObject(b){return(b instanceof Object||typeof(b)=="object");}function isString(b){return(b instanceof String||typeof(b)=="string");}function isUndefined(b){return((b==undefined)&&(typeof(b)=="undefined"));}function Map(c,a,b){this.elements={};this.len=0;this.separator=a?a:";";this.equal=b?b:"=";this.merge(c);}Map.prototype=new Object;Map.prototype.merge=function(d){var h=d;if(!h||h.length==0){return;}var i=this.separator;if(i=="\r\n"){i="\n";}else{if(i==null||i.length==0){i=";";}}var e=this.equal;var c=0;var b=h.indexOf(e,c);while(b!=-1){while(c<b&&(h.charAt(c)==i||h.charAt(c)=="\r")){c++;}var g=h.substring(c,b);var f;c=b+e.length;if(c<h.length&&h.charAt(c)=='"'){var a=new extractQuotedStr(h,'"',c);f=a.getValue();c=a.getEndIndex()+i.length;}else{b=h.indexOf(i,c);if(b==-1){b=h.length;}f=h.substring(c,i=="\n"&&h.charAt(b-1)=="\r"?b-1:b);c=b+i.length;}b=h.indexOf(e,c);this.setValue(g,f);}};Map.prototype.put=function(b,c){if(isUndefined(c)){c=null;}var a=this.elements[b];this.elements[b]=c;if(isUndefined(a)){this.len++;return c;}else{return a;}};Map.prototype.push=Map.prototype.put;Map.prototype.renameKey=function(b,c){if(this.containsKey(b)){var a=this.removeValue(b);if(!this.containsKey(c)){this.setValue(c,a);}}};Map.prototype.containsKey=function(a){return a in this.elements;};Map.prototype.putMap=function(b){for(var a in b.elements){this.put(a,b.elements[a]);}};Map.prototype.putMapIgnoreCase=function(d){var c=this.keySet();for(var b in d.elements){if(this.contains(b)){this.put(b,d.elements[b]);}else{var a=c.indexOfIgnoreCase(b);if(a>-1){this.remove(c[a]);}this.put(b,d.elements[b]);}}};Map.prototype.remove=function(a){var b=this.elements[a];if(isUndefined(b)){return null;}delete this.elements[a];this.len--;return b;};Map.prototype.size=function(){return this.len;};Map.prototype.length=Map.prototype.size;Map.prototype.get=function(c){var b=0;var d=null;if(isNumber(c)){for(var a in this.elements){if(b++==c){d=this.elements[a];break;}}}else{d=this.elements[c];}return isUndefined(d)?null:d;};Map.prototype.contains=function(a){var b=this.elements[a];return !isUndefined(b);};Map.prototype.clear=function(){for(var a in this.elements){delete this.elements[a];}this.len=0;};Map.prototype.keySet=function(){var b=new Array();for(var a in this.elements){if(!isUndefined(a)){b.push(a);}}return b;};Map.prototype.valueSet=function(){var a=new Array();for(var b in this.elements){if(isUndefined(b)){continue;}var c=this.elements[b];a.push(c);}return a;};Map.prototype.export2str2=function(d,b){var a=new Array();for(var c in this.elements){if(isUndefined(c)){continue;}if(d){a.push(c);}else{a.push(this.elements[c]);}}return a.join(b?b:";");};Map.prototype.export2str=function(f,d){var a=new Array();var e="";if(!d){d="=";}for(var b in this.elements){e=b;e+=d;var c=this.elements[b];if(c==null){c="";}if(isString(c)&&((c.indexOf(f)!=-1)||(c.indexOf(d)!=-1)||(c.indexOf('"')!=-1))){c=quotedStr(c,'"');}e+=c;a.push(e);}return a.join(f?f:";");};Map.prototype.clone=function(){var b=new Map();b.len=this.len;b.separator=this.separator;b.equal=this.equal;b.elements={};for(var a in this.elements){b.elements[a]=this.elements[a];}return b;};Map.prototype.export2uri=function(){return this.toString2(null,"&",true);};Map.prototype.toString2=function(c,g,e){var a=[];var f="";if(!c){c="=";}if(!g){g=";";}var d=this.size();var h;for(var b in this.elements){f=b;f+=c;h=this.elements[b];if(h==undefined||h==null){h="";}f+=(!e?h:encodeURIComponent(h));a.push(f);}return a.join(g);};Map.prototype.toArray=function(d){d=typeof(d)=="boolean"?d:true;var a=[];var c;for(var b in this.elements){c=this.elements[b];if(!c){c="";}a.push([b,!d?c:encodeURIComponent(c)]);}return a;};Map.prototype.getValue=function(b,c){var a=this.get(b);return a==null?c:a;};Map.prototype.getInt=function(a,c){var b=this.getValue(a);return b?parseInt(b):(c!=null?c:0);};Map.prototype.getFloat=function(a,c){var b=this.getValue(a);return b?parseFloat(b):(c!=null?c:0);};Map.prototype.getBool=function(a,c){var b=this.getValue(a);return parseBool(b,c);};Map.prototype.dispose=function(){};Map.prototype.setValue=function(a,b){this.put(a,b);};Map.prototype.removeValue=function(b,c){var a=this.remove(b);if(a==null){return c;}else{return a;}};Map.prototype.listEntry=function(){return this.elements;};Map.prototype.toJson=function(){return this.elements;};Map.prototype.formJson=function(a){this.clear();this.putJson(a);};Map.prototype.putJson=function(a){for(var b in a){this.put(b,a[b]);}};Map.prototype.toString=function(){return this.export2str(this.separator);};Map.create=function(a){var b=new Map();if(a){b.putJson(a);}return b;};StringMap=Map;function StringBuffer(a){this._buffer=[];this.append(a);}StringBuffer.prototype={append:function(a){if(a){this._buffer.push(a);}},toString:function(a){return this._buffer.join(a?a:"");},clear:function(){this._buffer.length=0;},length:function(){return this._buffer.length;},insert:function(b,c){var a=this.length();if(b>a||a<b){return false;}this._buffer=this._buffer.slice(0,b).concat([c]).concat(this._buffer.slice(b));return true;},reverse:function(){this._buffer.reverse();}};function parseDate(b){if(b&&typeof(b)=="object"&&b.toLocaleDateString){return b;}var c=new Date();var f=c.getFullYear(),j=c.getMonth()+1,k=c.getDate();if(typeof(b)=="string"&&b.length>=4){if(!isNaN(b)){f=new Number(b.substring(0,4)).valueOf();try{var a=b.substring(4,6);var h=b.substring(6,8);j=a.length>0?new Number(a).valueOf():1;k=h.length>0?new Number(h).valueOf():1;}catch(g){}}else{if(new RegExp("(----)","").test(b)){f=new Number(b.substring(0,4)).valueOf();k=1;}else{if(new RegExp("(--)","").test(b)){f=new Number(b.substring(0,4)).valueOf();j=new Number(b.substring(4,6)).valueOf();k=1;}else{var i=b.split(new RegExp("[-\\/\\.(年|月|日)]",""));if(!i[i.length-1]){i.splice(i.length-1,1);}if(i.length==3){f=new Number(i[0]).valueOf();j=new Number(i[1]).valueOf();k=new Number(i[2]).valueOf();}if(i.length==2){f=new Number(i[0]).valueOf();j=new Number(i[1]).valueOf();k=1;}if(i.length==1){var d=i[0];f=new Number(d.substring(0,4)).valueOf();var a=d.substring(4,6);j=a.length>0?new Number(a).valueOf():1;k=1;}}}}c.setFullYear(f);c.setMonth(j-1,k);}return c;}function date2String(c,g){var j,h,k,e,d,m,a,f,l,n,b,i;if(!g){g="yyyy-mm-dd";}j=c.getFullYear().toString();if(j.length<4){if(j.length==0){j="0000";}else{if(j.length==1){j="000"+j;}else{if(j.length==2){j="00"+j;}else{if(j.length==3){j="0"+j;}}}}}a=j.substring(2,4);h=(c.getMonth()+1);f=h<10?"0"+h:h;k=c.getDate();l=k<10?"0"+k:k;e=c.getHours();n=e<10?"0"+e:e;d=c.getMinutes();b=d<10?"0"+d:d;m=c.getSeconds();i=m<10?"0"+m:m;return g.replace("yyyy",j).replace("mm",f).replace("dd",l).replace("yy",a).replace("m",h).replace("d",k).replace("hh",n).replace("ii",b).replace("ss",i).replace("h",e).replace("i",d).replace("s",m);}function LZ(a){return(a<0||a>9?"":"0")+a;}function parseBool(a,b){if(typeof(a)=="boolean"){return a;}if(typeof(a)!="string"){return(b!=null&&b!=undefined)?b:false;}a=a.toUpperCase();if(a=="TRUE"||a=="T"||a=="1"){return true;}else{if(a=="FALSE"||a=="F"||a=="0"){return false;}else{return(b!=null&&b!=undefined)?b:false;}}}function bigRandom(a){return Math.floor(Math.random()*(a?a:9999999999));}function idRandom(a){return a+"$"+bigRandom();}function toPerNumber(a){a=typeof(a)=="string"?(a.lastIndexOf("%")!=-1?a:((a=a.toLowerCase())&&a.lastIndexOf("px")!=-1?a:(a?a+"px":a))):(typeof(a)=="number"?a+"px":"100%");return a.charAt(0)=="-"?0:a;}function toPixNumber(b,a){if(typeof(b)=="number"){return b;}if(typeof(b)!="string"){return a;}return parseInt(b,10);}function getDefaultWaitDialog(a){return getObjectFromRootAsync("WaitDialog","__ESEN$WaitDialog__",true,"xdialog",a,true);}function hideWaitDialog(c,e,b){var a=getRootWindow();a.__ESEN$WaitDialog$IsVisible__=false;if(a.__ESEN$WaitDialog$Timeout__){a.clearTimeout(a.__ESEN$WaitDialog$Timeout__);a.__ESEN$WaitDialog$Timeout__=false;}var d=a["__ESEN$WaitDialog__"];if(!d){return;}d.hideDialog(c,e,b);}function hideWaitDialogWithComplete(a,b){hideWaitDialog(a,b,"xui/images/success_ani.gif");}function showWaitDialogAutoHidden(c,d,b){var a=getRootWindow();a.__ESEN$WaitDialog$IsVisible__=true;getDefaultWaitDialog(function(e){if(a.__ESEN$WaitDialog$IsVisible__){if(a.__ESEN$WaitDialog$Timeout__){a.clearTimeout(a.__ESEN$WaitDialog$Timeout__);}e.setCanResizable(false);a.__ESEN$WaitDialog$Timeout__=e.hideDialog(c,d,b);e.show();}});}function hideWaitingDom(a){if(!a){a="com.sanlink.irpt.web.waitingdom";}if(typeof(a)=="string"){a=document.getElementById(a);}if(a&&typeof(a)=="object"&&a.parentNode){a.parentNode.removeChild(a);}}function _onWindowError(d,b,a){if(window.execScripting){return;}if(isFirefox&&new RegExp("Location.toString","g").test(d)){return;}hideWaitDialog();hideWaitingDom();hideProgressDialog();try{sys.lib.include("xui/xwindow.js,xui/ctrls/xcommonctrls.js,xui/ctrls/xdialog.js");showError(d,isie?window.onerror.caller:null);}catch(c){alert(c);}return isie;}function getUniqueHtmlId(c,d){var a=getRootWindow();var b=a["ESEN$UniqueHtmlId4"+c];a["ESEN$UniqueHtmlId4"+c]=b=b?b+1:1;return d?d+b:b;}function showMemoDialog(a,c,b){getObjectFromRootAsync("MemoDialog","__ESEN$MemoDialog__",true,"xdialog",function(d){d.setContent(a,c);d.open(b);});}function showHelp(a,c,b){getHelp(a,c,b);}function getFloatHintMsg(){return getObjectFromRoot("FloatHintMsg","__ESEN$FloatHintMsg__",true,"xui/xwindow.js,xui/ctrls/xcommonctrls.js,xui/ctrls/xdialog.js");}function showFloatHintMsg(d,e,a,c){var b=getFloatHintMsg();b.setMessage(d);b.open(e,a);b.onclose=c;return b;}function getParameter(c,a){a=a?a:window;var b=getWndLocationSearch(a);return getParameterOfUrl(c,b);}function getParameterOfUrl(j,b){b=unescapeURIComponent(b);var a=b.indexOf("?");if(a>=0){b=b.substring(a+1);}var f=b.split("&");try{var a,d,g;for(var c=0;c<f.length;c++){g=j.length;d=f[c];if(d.substring(0,g+1)!=j+"="){continue;}a=d.indexOf(j+"=");if(a!=-1){return(d.substring(a+g+1));}}return"";}catch(h){return"";}}function getParameterMap(){var g=new Map();var b=window.location.search;b=unescapeURIComponent(b);var a=b.indexOf("?");if(a>=0){b=b.substring(a+1);}var e=b.split("&");var a,d,f;for(var c=0;c<e.length;c++){d=e[c];tmpp=d.split("=");if(tmpp!=null&&tmpp.length==2){g.put(tmpp[0],tmpp[1]);}}return g;}function setParameter(d,a,c){var b=getWndLocationSearch(c);return setParameterOfUrl(d,a,b);}function getWndLocationSearch(e){if(!e){e=window;}var d="";var a=e.location.href;var f=/(\?(.*)|\/)#(\w+):/g;if(isie6&&f.test(a)){var b=a.match(f);if(b&&b.length==1){var c=b[0].match(/^\?(.*)#/g);if(c&&c.length==1){d=c[0].substring(1,c[0].length-1);}}}if(!d&&(!(/#(\w+):/g).test(a)||!isie6)){d=e.location.search;}return d;}function setParameterOfUrl(j,k,a){var b=a;if(b&&typeof(b)=="string"&&b.length>0&&b.charAt(0)=="?"){var d=[];var c=b.substring(1).split("&");if(c==null||c.length==0){return"";}var f,h;var l=false;for(var e=0;e<c.length;e++){f=c[e];h=f.split("=");if(h!=null&&h.length==2&&h[0]==j){h[1]=k;f=h.join("=");l=true;}d.push(f);}if(!l){d.push(j+"="+k);}return("?"+d.join("&"));}else{var g=[];g.push(j+"="+k);return("?"+g.join("&"));}}function getParameterValues(j,a){a=a?a:window;var c=a.location.search.substring(1).split("&");var k=[];try{var d,b,g;for(var f=0;f<c.length;f++){b=j.length;d=c[f];if(d.substring(0,b+1)!=j+"="){continue;}g=d.indexOf(j+"=");if(g!=-1){k.push(d.substring(g+b+1));}}return k;}catch(h){return"";}}function getHost(){var c=window.location.href;var a=c.indexOf("?");if(a>-1){c=c.substring(0,a);}var b=c.lastIndexOf("/");return b!=-1?c.substring(0,b+1):"";}function LineReader(a){this.s=a;this.index=0;}LineReader.prototype.readLine=function(){var a=this.index;if(a==-1){return null;}var c=this.s;var b=c.indexOf("\n",a);if(b==-1){this.index=b;return c.substring(a);}else{this.index=b+1;if(c.charAt(b-1)=="\r"){b--;}return c.substring(a,b);}};LineReader.prototype.eof=function(){return this.index==-1;};LineReader.prototype.readLineUtil=function(a){var c=this.readLine();var b="";while(c!=a&&!this.eof()){b+=c+"\r\n";c=this.readLine();}return b.trim();};LineReader.prototype.skipLineUtil=function(){this.readLineUtil();};LineReader.prototype.getRemain=function(){return this.s.substring(this.index);};function TxtLoader(a){this.sectionArray=new Array();this.content=a;this.sectionCount=0;this.arglen=arguments.length;this.args=arguments;this.init();return this;}function mySetInterval(f,e,a,g,d,c){var b=f.setInterval(function(){CallBackFunc.doCallBack(e,g,d,c);},a);return b;}function mySetTimeout(f,e,a,g,d,c){var b=f.setTimeout(function(){CallBackFunc.doCallBack(e,g,d,c);},a);return b;}function setTimeout_killExistFirst(c,d,b,a){if(!b){b=window;}var a="_timer_of_setTimeout_killExistFirst"+a;var e=b[a];if(e){b.clearTimeout(e);b[a]=0;}b[a]=b.setTimeout(c,d);}function setTimeoutCached(e,b,f){var c="__bindme_"+b;var d=e[c];if(typeof(d)!="function"){var a=e[b];d=function(){return a.apply(e);};e[c]=d;}return setTimeout(d,f);}function openIframeUrl(b,c,d){if(!b.startsWith(sys.getContextPath())){b=sys.getRequestURL()+b;}if(!c){c=getRootWindow();}var m=c.document;var h=c.document.body;var a=new HtmlElementFactory(c);var e=c["__OpenIframeUrlForm__"];if(!e){e=c["__OpenIframeUrlForm__"]=h.appendChild(a.form("$openIframeUrlForm",null,"post",null,true));e.style.display="none";}var l=e.getIFrame().contentWindow.document;if(isie&&l.charset.toLowerCase()!="utf-8"){l.charset="utf-8";}var k=e.childNodes.length;if(k>0){var g;for(var f=k-1;f>=0;f--){g=e.childNodes[f];if(g.nodeType!=1||g.tagName.toLowerCase()=="iframe"){continue;}e.removeChild(g);}}e.setAction(b);if(d){var o=d.keySet();var n;for(var f=0,j=o.length;f<j;f++){n=o[f];if(!n){continue;}e.appendChild(a.hidden(d.get(n),n));}}e.submit();}function downloadViaServer(h,c,j){var d=getRootWindow();var g=d.document.body;var f=sys.getContextPath()+"helpjsdownload.do";var i="";var b="post";var e=d["__HelpJsDownload__"];if(!e){var a=new HtmlElementFactory(d,g);e=d["__HelpJsDownload__"]=a.form("helpJsDownloadForm",i,b,f,true);e.style.display="none";e.appendChild(d.document.createElement("textarea")).name="content";e.appendChild(d.document.createElement("input")).name="fn";e.appendChild(d.document.createElement("input")).name="contenttype";}if(h&&e.childNodes[1]){e.childNodes[1].value=h;}if(c&&e.childNodes[2]){e.childNodes[2].value=c;}if(j&&e.childNodes[3]){e.childNodes[3].value=j;}e.submit();}function validate(a,b,c){if(!a){return"";}if(typeof(b)!="object"&&typeof(b)!="function"){b=/[^A-Z^a-z^0-9^\-^\_^\.]/g;}if(!c){c="";}return a.replace(b,c);}function invertColor(a){if(typeof(a)=="string"&&a.charAt(0)=="#"){a=a.substring(1);}var b=parseInt(a,16);b=16777215-b;var c=b.toString(16);if(c.length>6){return c.substring(c.length-6);}else{for(var b=c.length;b<6;b++){c="0"+c;}}return c;}function color2int(a){if(typeof(a)=="string"){if(a.charAt(0)=="#"){a=a.substring(1);a=parseInt(a,16);}else{a=parseInt(a,16);}}return a;}function getPercent(b,a){return((b/a)*100);}function getPixel(b,a){return(b*(a/100));}function getPercent2(b,a){return(100-((b/a)*100))+"%";}var InputValidate={};InputValidate._initObject=function(b,a){if(typeof(b)=="string"&&b.length>0){b=document.getElementById(b);}if(typeof(b)=="object"&&b.tagName&&"INPUT".equalsIgnoreCase(b.tagName)){b.onkeydown=function(c){if(!c){c=getWndOfDom(b).event;}if(typeof(a)=="function"){return a(c);}};b.oncontextmenu=returnfalse;}};InputValidate.Number=function(a){InputValidate._initObject(a,function(b){if((b.ctrlKey&&b.keyCode==86)||(b.keyCode>57&&b.keyCode>48)){return false;}});};InputValidate.English=function(a){InputValidate._initObject(a,function(b){if(b.keyCode>128){return false;}});};InputValidate.Chinese=function(a){InputValidate._initObject(a,function(b){if(b.keyCode>32&&b.keyCode<128){return false;}});};InputValidate.Replace=function(c,b,a){if(typeof(c)=="string"&&c.length>0){c=document.getElementById(c);}if(typeof(c)=="object"&&c.tagName&&"INPUT".equalsIgnoreCase(c.tagName)){if(typeof(b)!="object"&&typeof(b)!="function"){b=/[^A-Z^a-z^0-9^\-^\_^\.]/g;}if(c.value!=null&&c.value.length>0){c.value=c.value.replace(b,a?a:"");}}};InputValidate.test=function(b,a){if(typeof(b)=="string"&&b.length>0){b=document.getElementById(b);}if(typeof(b)=="object"&&b.tagName&&"INPUT".equalsIgnoreCase(b.tagName)){if(typeof(a)!="object"&&typeof(a)!="function"){a=/[^A-Z^a-z^0-9^\-^\_^\.]/g;}return a.test(b.value);}};function InnerHTML2Edit(c,b,a){if(typeof(c)=="string"&&c.length>0){c=document.getElementById(c);}if(typeof(b)=="string"&&b.length>0){b=document.getElementById(b);}if(typeof(b)=="object"&&b.tagName&&"INPUT".equalsIgnoreCase(b.tagName)&&typeof(c)=="object"){if(typeof(a)!="boolean"){a=false;}b.style.color="#000000";b.value=a?c.extInfo:c.innerHTML;}}function inputElement(h,f,a,g,e){h=h?h:document;f=!f?"text":f.toLowerCase();var c=f=="radio"||f=="checkbox";var i=typeof(e)=="boolean"?e:false;var b=idRandom(f);var d=h.createElement("div");d.innerHTML='<input type="'+f+'" name="'+(a?a:b)+'" id="'+b+'"'+(c&&isMSIE&&i?" checked":"")+(g?' value="'+g+'"':"")+"/>";var j=d.firstChild;d=null;return j;}function buttonElement(e,f,c,d){var b=e.createElement("div");b.innerHTML='<button type="'+(c||"button")+'">'+(f||"")+"</button>";var a=b.firstChild;b=null;if(d){a.onclick=d;}return a;}function getBackGroundIFrame(doc){if(!doc){doc=document;}var ifms=doc.getElementsByTagName("iframe");var ifm;for(var i=0;ifms&&i<ifms.length;i++){ifm=ifms[i];if(ifm.id=="SAN_BACKGROUND_IFRAME_ID"&&ifm.style.left=="-99999px"&&ifm.style.top=="0px"){return ifm;}}ifm=doc.createElement("iframe");ifm.id="SAN_BACKGROUND_IFRAME_ID";ifm.setAttribute("frameborder","0",0);ifm.setAttribute("marginheight","0",0);ifm.setAttribute("marginwidth","0",0);with(ifm.style){position="absolute";left="-99999px";top=0;display="";zIndex=-1;}doc.body.appendChild(ifm);return ifm;}function showBackGroundIFrame(c,b){if(!isie){return;}if(b){var a=c._back_ground_iframe;if(!a){a=getBackGroundIFrame(c.ownerDocument);}if(a.parentNode!=c.parentNode){a.parentNode.removeChild(a);c.parentNode.appendChild(a);}a.style.left=c.offsetLeft+"px";a.style.top=c.offsetTop+"px";a.style.width=c.offsetWidth+"px";a.style.height=c.offsetHeight+"px";var d=getCurrentStyle(c,"zIndex");a.style.zIndex=d==="auto"?-1:(d-1);a.style.display="";c._back_ground_iframe=a;a._in_used=true;return a;}else{var a=c._back_ground_iframe;c._back_ground_iframe=null;if(!a){return;}a._in_used=false;a.style.left="-99999px";a.style.top=0;a.style.width=0;a.style.height=0;a.style.zIndex=0;a.style.display="";if(a.parentNode!=a.ownerDocument.body){a.parentNode.removeChild(a);a.ownerDocument.body.appendChild(a);}}}function showHintMessage(dom,icon,msg,detaillogs){var doc=document;var parentElement=typeof(dom)=="string"?doc.getElementById(dom):(typeof(dom)=="object"?dom:doc.body);if(parentElement._showmessage==null){var table=doc.createElement("table");with(table){border=0;cellSpacing=2;cellPadding=0;with(style){width="100%";border="1px dashed #aca899";backgroundColor="#fffff1";}}var row=table.insertRow(-1);var cell=row.insertCell(-1);with(cell){vAlign="top";with(style){height="1%";padding="2px";backgroundColor="#ffcccc";}}var img=cell.appendChild(doc.createElement("img"));with(img){align="absMiddle";style.styleFloat="left";style.cssFloat="left";if(icon!=null){src=icon;}else{src="ebi/images/warning.gif";}}img.onclick=function(){eval("hideHintMessage(parentElement)");};table.img=img;var a=cell.appendChild(doc.createElement("a"));with(a){className="Blink";href="javascript:;";style.styleFloat="left";style.cssFloat="left";}a.onclick=function(){eval(""+"var style=a.parentNode.parentNode.parentNode.parentNode.rows[1].style;"+"style.display=style.display=='none'?'':'none';"+"");};table.a=a;var div=cell.appendChild(doc.createElement("div"));table.text=div;row=table.insertRow(-1);table.row=row;row.style.display="none";cell=row.insertCell(-1);with(cell){vAlign="top";style.height="150px";style.padding="2px";}div=cell.appendChild(doc.createElement("div"));with(div.style){position="relative";width="100%";height="100%";overflow="hidden";}div=div.appendChild(doc.createElement("div"));with(div.style){position="absolute";width="100%";height="100%";overflow="auto";}table.detail=div;parentElement._showmessage=table;parentElement.appendChild(table);}var setvalue=function(dom,value){if(value==null||value.length==0){dom.innerHTML="&nbsp;";}else{setTextContent(dom,value);}};var table=parentElement._showmessage;if(detaillogs==null){table.a.style.display="none";table.text.style.display="";setvalue(table.text,msg);}else{table.a.style.display="";table.text.style.display="none";setvalue(table.a,msg);setvalue(table.detail,detaillogs);}table.row.style.display="none";table.style.display="";}function hideHintMessage(b){var a=typeof(b)=="string"?document.getElementById(b):(typeof(b)=="object"?b:this.doc.body);if(a._showmessage!=null){a._showmessage.style.display="none";}}function createPngImg(imgurl,pdom){var rs;if(isie6){rs=document.createElement("div");with(rs.style){filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+img+'",sizingMethod="image")';backgroundColor="transparent";height="20px";}}else{rs=document.createElement("img");rs.src=img;rs.border=0;}return pdom?pdom.appendChild(rs):rs;}function setCursorPosition(c,d,a){if(c.setSelectionRange){c.focus();c.setSelectionRange(d,a?a:d);}else{if(c.createTextRange){var b=c.createTextRange();b.collapse(true);b.moveEnd("character",a?a:d);b.moveStart("character",d);b.select();}}}function insertAtCursor(b,c){try{b.focus();}catch(d){}if(document.selection){document.selection.createRange().text=c;}else{if(b.selectionStart||b.selectionStart==0){var a=b.selectionStart+c.length;b.value=b.value.substring(0,b.selectionStart)+c+b.value.substring(b.selectionEnd);b.setSelectionRange(a,a);}else{b.value+=c;}}}function selectValue(b){if(b.disabled){return;}try{b.focus();b.select();}catch(a){}}function DomHelper(a){this.wnd=a?a:window;this.doc=this.wnd.document;this.re=/\{([\w-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g;this.tableRe=/^table|tbody|tr|td$/i;}DomHelper.prototype.replaceHtml=function(b,a){if(isArray(b)){b=b.join("");}var c=function(d,e){return a[e]!==undefined?a[e]:"";};return b.replace(this.re,c);};DomHelper.prototype.insertFirst=function(b,a){return this._doInsert("afterBegin",b,a);};DomHelper.prototype.insertBefore=function(b,a){return this._doInsert("beforeBegin",b,a);};DomHelper.prototype.insertAfter=function(b,a){return this._doInsert("afterEnd",b,a);};DomHelper.prototype.append=function(b,a){return this._doInsert("beforeEnd",b,a);};DomHelper.prototype._doInsert=function(a,c,b){return this._insertHtml(a,c,b);};DomHelper.prototype._insertHtml=function(c,e,d){c=c.toLowerCase();if(e.insertAdjacentHTML){if(this.tableRe.test(e.tagName)){var b;if(b=this._insertIntoTable(e.tagName.toLowerCase(),c,e,d)){return b;}}switch(c){case"beforebegin":e.insertAdjacentHTML("BeforeBegin",d);return e.previousSibling;case"afterbegin":e.insertAdjacentHTML("AfterBegin",d);return e.firstChild;case"beforeend":e.insertAdjacentHTML("BeforeEnd",d);return e.lastChild;case"afterend":e.insertAdjacentHTML("AfterEnd",d);return e.nextSibling;}return;}var a=e.ownerDocument.createRange();var f;switch(c){case"beforebegin":a.setStartBefore(e);f=a.createContextualFragment(d);e.parentNode.insertBefore(f,e);return e.previousSibling;case"afterbegin":if(e.firstChild){a.setStartBefore(e.firstChild);f=a.createContextualFragment(d);e.insertBefore(f,e.firstChild);return e.firstChild;}else{e.innerHTML=d;return e.firstChild;}case"beforeend":if(e.lastChild){a.setStartAfter(e.lastChild);f=a.createContextualFragment(d);e.appendChild(f);return e.lastChild;}else{e.innerHTML=d;return e.lastChild;}case"afterend":a.setStartAfter(e);f=a.createContextualFragment(d);e.parentNode.insertBefore(f,e.nextSibling);return e.nextSibling;}};DomHelper.prototype.getTableDom=function(g,d,c,f){tempTableEl=this.doc.createElement("div");tempTableEl.innerHTML=[d,c,f].join("");var a=-1,b=tempTableEl;while(++a<g){b=b.firstChild;}return b;};DomHelper.ts="<table>",DomHelper.te="</table>",DomHelper.tbs="<table><tbody>",DomHelper.tbe="</tbody></table>",DomHelper.trs="<table><tbody><tr>",DomHelper.tre="</tr></tbody></table>";DomHelper.prototype._insertIntoTable=function(a,b,d,c){var e;var f=null;if(a=="td"){if(b=="afterbegin"||b=="beforeend"){return;}if(b=="beforebegin"){f=d;d=d.parentNode;}else{f=d.nextSibling;d=d.parentNode;}e=this.getTableDom(4,DomHelper.trs,c,DomHelper.tre);}else{if(a=="tr"){if(b=="beforebegin"){f=d;d=d.parentNode;e=this.getTableDom(3,DomHelper.tbs,c,DomHelper.tbe);}else{if(b=="afterend"){f=d.nextSibling;d=d.parentNode;e=this.getTableDom(3,DomHelper.tbs,c,DomHelper.tbe);}else{if(b=="afterbegin"){f=d.firstChild;}e=this.getTableDom(4,DomHelper.trs,c,DomHelper.tre);}}}else{if(a=="tbody"){if(b=="beforebegin"){f=d;d=d.parentNode;e=this.getTableDom(2,DomHelper.ts,c,DomHelper.te);}else{if(b=="afterend"){f=d.nextSibling;d=d.parentNode;e=this.getTableDom(2,DomHelper.ts,c,DomHelper.te);}else{if(b=="afterbegin"){f=d.firstChild;}e=this.getTableDom(3,DomHelper.tbs,c,DomHelper.tbe);}}}else{if(b=="beforebegin"||b=="afterend"){return;}if(b=="afterbegin"){f=d.firstChild;}e=this.getTableDom(2,DomHelper.ts,c,DomHelper.te);}}}d.insertBefore(e,f);return e;};function returnfalse(){return false;}function returntrue(){return true;}function returnNull(){}function __getInstance4InputDialog(e,a,c,b,g,f,d){getObjectFromRootAsync(e,"__ESEN$"+e+"__",true,"xui/xwindow.js,xui/ctrls/xcommonctrls.js,xui/ctrls/xcombobox.js,xui/ctrls/xdialog.js",function(h){h.setCanResizable(d);h.setParams(a,c,b,g);h.setEnabled(true);h.open(typeof(f)=="boolean"?f:((f&&typeof(f._initXDialog)=="function")?f:!(h.wnd==window)));h.wnd.setTimeout(h.setFocus.bind(h),0);});}function inputDialog(a,c,b,e,d){isArray(e)?editComboboxDialog(a,c,b,e,d):__getInstance4InputDialog("XInputDialog",a,c,b,e,d);}function textAreaDialog(a,c,b,e,d){__getInstance4InputDialog("XTextAreaDialog",a,c,b,e,d,true);}function comboboxDialog(a,c,b,e,d){__getInstance4InputDialog("XComboboxDialog",a,c,b,e,d);}function editComboboxDialog(a,c,b,e,d){__getInstance4InputDialog("XEditComboboxDialog",a,c,b,e,d);}function numberDialog(a,d,c,b,e,h,g,f){getObjectFromRootAsync("NumberDialog","__ESEN$NumberDialog__",true,"xui/xwindow.js,xui/ctrls/xcommonctrls.js,xui/ctrls/xspinner.js,xui/ctrls/xdialog.js",function(i){i.setParams(a,d,c,b,e,h,f);i.open(typeof(g)=="boolean"?g:!(i.wnd==window));});}function inputDialog2(f,e,c,b,d,a,h,g){getObjectFromRootAsync("XInputDialog2","__ESEN$"+"XInputDialog2"+"__",true,"xui/xwindow.js,xui/ctrls/xcommonctrls.js,xui/ctrls/xdialog.js",function(i){i.setCanResizable(false);i.setParams(f,e,c,b,d,a,h,g);i.setEnabled(true);i.open(typeof(isModel)=="boolean"?isModel:!(i.wnd==window));i.wnd.setTimeout(i.setFocus.bind(i),0);});}function showMessage(e,c,d,b){var a=getMessageDialog();a.setParams(e,c,d,b);a.showModal();return a;}function getMessageDialog(){return getObjectFromRoot("ShowMessage","__ESEN$ShowMessage__",true,"xui/xwindow.js,xui/ctrls/xcommonctrls.js,xui/ctrls/xdialog.js");}function showMessageInNode(c,b,a,d){sys.lib.includeAsync("xpanel",window,function(){var e=c&&typeof(c)=="string"?document.getElementById("hintContainer"):c;if(!e){return;}var f=window["msgPanel"];if(!f){f=new XHintPanel(window,e);window["msgPanel"]=f;addDispose(f);}f.setStayTime(d);f.setMessage(b,a);});}function showError(d,c){if(window.parent&&window.parent.mode){var a=unescape(typeof(d)==Error?d.message:d);var b=a.indexOf("--detailmessage--");a=a.substring(0,b>0?b:a.length);alert(a);return;}if((d instanceof Error)&&(d.httpstatus==401||d.httpstatus>=12000)){getObjectFromRootAsync("XShowHttpError","__ESEN$XShowHttpError__",true,"xdialog",function(e){var g=getRootWindow();var f=g["__ESEN$XShowError__"];if(!!f&&f.isVisible()){f.close();}e.resize(400,150);if(e.isVisible()){e.setParams(d);return e;}e.setParams(d);e.showModal();});}else{getObjectFromRootAsync("ShowError","__ESEN$XShowError__",true,"xdialog",function(e){if(e.isVisible()){if(!e.errorCalls){e.errorCalls=[];}e.errorCalls.push([e,d,c]);return e;}e.setParams(d,c);e.showDetail(false);e.showModal();});}}function confirmDialog(d,c,b,e){var a=arguments;getObjectFromRootAsync("ConfirmDialog","__ESEN$ConfirmDialog__",true,"xdialog",function(f){if(typeof(e)=="function"){e(f);}f.showModal();var h=null,g=null;if(typeof(c)=="object"){h=c.msg;g=c.icon;}else{if(typeof(c)=="string"||typeof(c)=="number"){h=c;}}f.setParams(d,h,b,g);if(f._isYesNo){f.setOnYes(a[4]);f.setOnNo(a[5]);}else{f.setOnOK(a[4]);}f.setOnCancel(a[f._isYesNo?6:5]);});}function hiddenConfirmDialog(){getObjectFromRootAsync("ConfirmDialog","__ESEN$ConfirmDialog__",true,"xdialog",function(a){a.close();});}function getConfirmDialog(){return getObjectFromRoot("ConfirmDialog","__ESEN$ConfirmDialog__");}function progressDialog(){return getObjectFromRoot("ProgressDialog","__ESEN$ProgressDialog__",true,"xui/xwindow.js,xui/ctrls/xcommonctrls.js,xui/ctrls/xdialog.js");}var uploadDialog=(function(){var h=getRootWindow()["uploadDialog"];if(h){return h;}var t=null,j=null,u=null,f=null,i=null,b=null,n=null,m=null,a=[],l=null;var c=null,o=null,e=null,p=/^([\u4E00-\uFA29]|[\uE7C7-\uE7F3]|\w)+(\.[A-Z|a-z]+)?$/;var q=function(y){if(!e){return;}hideWaitDialog();var z=y.contentWindow;if(z.document.getElementById("exceptionInfo")){showMessage(I18N.getString("esmain.portal.js.xfileview.js.6","上传文件失败!"));e=false;return;}if(typeof(u)==="function"){u.call(z,e,f);}e=null;};var g=function(){var z=this.value,y=z.lastIndexOf("\\");b.value=z.substr((y===-1?z.lastIndexOf("/"):y)+1);};var k=function(y){if((y||window.event).keyCode===8){j.reset();}};var r=function(){j.reset();};var x=function(){j.submit();t.close();showWaitDialog(I18N.getString("ES.COMMON.UPLOADING","正在上传......"));};var d=function(y,B){e=b.value;if(!e){showMessage(I18N.getString("esmain.portal.js.portaldesigner.js.17","未选择任何文件."));return;}if(!p.test(e)){showMessage(I18N.getString("esmain.portal.js.portaldesigner.js.18","上传文件文件名中含有非法字符\r\n文件名称只能由汉字、字母、数字或下划线组成."));return;}if(c){if(e.endsWith(".zip")&&n.checked&&m.checked){confirmDialog(I18N.getString("ES.COMMON.AFFIRM","确认"),"解压文件后将可能直接覆盖解压后的同名文件(夹)，是否继续解压上传？",false,null,x);return;}else{try{var A={command:c,name:i.value+"/"+e};if(l){extendObj(A,l);}if(queryObj(o,Map.create(A))!=="null"){confirmDialog(I18N.getString("ES.COMMON.AFFIRM","确认"),I18N.getString("esmain.portal.js.xfileview.js.9","文件【{0}】已存在,是否继续上传并覆盖该文件？",[e]),false,null,x);return;}}catch(z){showError(z);return;}}}x();};var w=function(y,z){z.close();};function v(){this.value=this.checked;}function s(){t.dispose();n.onchange=null;input_file.onchange=null;b.onkeydown=null;getRootWindow()["__ESEN$UploadDialog__"]=null;t=null;j=null;u=null;f=null;i=null;b=null;n=null;c=null;o=null;p=null;q=null;g=null;k=null;r=null;x=null;d=null;w=null;v=null;uploadDialog=null;}return function(C,F,y,E,z,B,D,A){getObjectFromRootAsync("XDialog","__ESEN$UploadDialog__",false,"xdialog",function(P){if(!j){addDispose(s);t=P;P.setCaption(I18N.getString("esmain.portal.js.portaldesigner.js.14","上传文件"));P.setWidth(370);P.setHeight(150);if(!(ieVersion<=8)){P.setPadding4Content(10);}P.setMaxButtonVisible(false);P.setCanResizable(false);j=P.getContent().appendChild(new HtmlElementFactory().form(getUniqueHtmlId("XFileUploadPanel","_Form4XFileUploadPanel_"),"multipart/form-data","post",null,true,q));j.style.cssText+="; display: block; width: 100%; height: 100%; overflow: hidden;";j.iframe.style.cssText+="; position: absolute; top: 0;";var S=j.appendChild(P.doc.createElement("div"));S.style.cssText+="; width: 100%; height: 100%; border: none; padding: 10px 26px; *padding: 0px; position: relative; text-align: center;";var J=I18N.getString("xui.util.js.45","选择文件"),K=I18N.getString("esmain.portal.js.portalmanager.js.39","是否解压"),L=I18N.getString("xui.util.fileupload.overwrite","解压覆盖"),H=I18N.getString("xui.util.fileupload.unziptip","勾选后如果上传的文件为zip压缩文件将自动解压"),I=I18N.getString("xui.util.fileupload.unziptip","勾选后上传的文件或解压后的文件将直接覆盖服务器中的同名文件"),Q="：";S.innerHTML='<table style="height: 100%; border: none"><tbody><tr>'+'<td style="width: 80px; height: 20px; *width: 70px; *height: 10px; text-align: right; vertical-align: middle; padding: 5px 0px; *padding: 10px 0 5px 10px">'+J+Q+"</td>"+'<td style="text-align: left; *padding-top: 4px"><div style="margin-right: 10px; display: inline; position: relative;">'+'<input style="border: 1px solid #CCC; width: 260px; height:20px; *height: 16px; background: #FFF;" readOnly="true"/>'+'<div style="position: absolute; top: 1px; *top: 3px; right: 3px; overflow: hidden; width: 16px; height: 16px; cursor: pointer" title="'+J+'">'+'<input title= "'+J+'" name="file" type="file" style="position: absolute; cursor: pointer; width: 16px; height: 16px; filter: Alpha(Opacity=0); opacity: .0" />'+'<input name="destdir" style="width: 0px; border: none; padding: 0;"/><img src="'+sys.getImgPath("add.gif")+'" /></div></div></td>'+'</tr><tr><td colspan="2" style="height: 20px; *height: 10px; text-align: left; vertical-align: middle; padding: 5px 0px; *padding: 5px 0 10px 10px">'+'<label style="padding-right: 26px;" title="'+H+'">'+K+Q+'<input name="unzip" type="checkbox" checked="true" /></label>'+'<label style="padding-right: 26px;" title="'+I+'">'+L+Q+'<input name="overwrite" type="checkbox" checked="true" /></label>'+"</td>"+"</tr></tbody></table>";disableDocTextSelect(S);var M=S.firstChild.rows,R=M[1].cells[0];b=M[0].cells[1].firstChild.firstChild;var N=b.nextSibling.firstChild;i=N.nextSibling;n=R.firstChild.lastChild;n.onchange=v;m=R.lastChild.lastChild;m.onchange=v;N.onchange=g;b.onkeydown=k;P.addButton(I18N.getString("ES.COMMON.CONFIRM","确定")).setOnClick(d,P);P.addButton(I18N.getString("ES.COMMON.CANCEL","取消")).setOnClick(w,P);P.setOnClose(r);}if(C&&C!==o){o=j.action=C;j.setAttribute("action",C);c=B===false?false:(B||"isexists");}var T=false,O=n.parentNode;if(E===true||E===false){O.style.display="";n.checked=n.value=E;T=true;}else{O.style.display="none";n.checked=E!==null;}if(z===true||z===false){m.parentNode.style.display="";m.checked=m.value=z;T=true;}else{m.parentNode.style.display="none";m.checked=z!==null;}O.parentNode.parentNode.style.display=T?"":"none";u=F;f=D;var U=-1,W=j.lastChild,X=P.doc;if(A){for(var Y in A){var G=a[++U];if(!G){G=a[U]=W.appendChild(X.createElement("input"));G.style.cssText+="; position: absolute; left: -1px; top: -1px; width: 1px; height: 1px;";}G.name=Y;G.setAttribute("value",A[Y]);G.value=A[Y];}}for(var V=a.length;(++U)<V;){W.removeChild(a[U]);}l=A;i.value=y;P.showModal();});};})();function hideProgressDialog(b,c,a){progressDialog().hideDialog(b,c,a);}function hideProgressDialogWithComplete(a,b){hideProgressDialog(a,b,"xui/images/success_ani.gif");}function isXML(a){return typeof(a)=="string"&&new RegExp("<.+>","g").test(a);}function parseXML(d,h,c){if(d&&typeof(d)=="object"){if(typeof(h)=="function"){h(d,c);}return d;}var e=new RegExp("(.xml)$","ig").test(d);var b=isXML(d)&&!e;if(b){var a=loadXMLString(null,d);if(h){h(a.documentElement?a.documentElement:a,c);}return a.documentElement?a.documentElement:a;}var g;var f=typeof(h)=="function";if(e){g=xmlhttp();g.open("GET",d,f);if(f&&typeof(h)=="function"){if(window.DOMParser){g.onload=function(){h(g.responseXML,c);g.onload=null;};}else{g.onreadystatechange=function(){if(g.readyState==4){h(g.responseXML,c);if(typeof(g.onreadystatechange)!="unknown"){g.onreadystatechange=null;}}};}}g.send(null);if(!f&&typeof(h)=="function"){h(g.responseXML,c);}if(!f){return g.responseXML;}}}function getXMLDOMInstance(){if(document.implementation&&document.implementation.createDocument){return document.implementation.createDocument("","",null);}var a=["Microsoft.XMLDOM","MSXML2.DOMDocument.6.0","MSXML2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument"];for(var b=0;b<a.length;b++){try{return new ActiveXObject(a[b]);}catch(c){}}return null;}function serialize2String(c,g){var d="";if(g){d+='<?xml version="1.0" encoding="'+g+'"?>';}var a="";try{a=new XMLSerializer().serializeToString(c);}catch(f){a=c.xml;}if(a.startsWith("<?")){var b=a.indexOf("<",1);a=a.substring(b);}return d+a;}function loadXMLString(b,a){if(a){var c=a.indexOf("<");if(c>0){a=a.substring(c);}}if(window.DOMParser){try{b=a?new DOMParser().parseFromString(a,"text/xml"):getXMLDOMInstance();}catch(d){b=getXMLDOMInstance();}}else{if(!b){b=getXMLDOMInstance();}if(a){b.async=false;b.loadXML(a);}}return b.documentElement?b.documentElement:b;}function getXmlNodeProperty(d,c,a){if(!d){return;}if(typeof(d)=="string"){d=loadXMLString(null,d);}var b=d.getAttribute(c);return b?b:a;}function clone(d,b){var c=b?b:new Object();for(var a in d){c[a]=d[a];}return c;}function showTestMsg(a){top.document.title=a;}function autoCloseBrowser(a){if(!a||!a.navigator){a=window;}a.opener=null;a.open("","_self");a.close();}function getSwfVersion(d){if(!d){d=window;}var b=0;try{var c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.10");if(c){b=10;}}catch(f){var a=d.navigator.plugins;if(a&&a.length>0){var c=a["Shockwave Flash"];if(c){b=parseInt(c.description.split(" ")[2].split(".")[0],10);}}}return b;}function openWindow(a){window.open(a);}function printDebugInfo(a){getObjectFromRootAsync("DebuggerDlg","_ESEN$DEBUGGER__",true,"xui/debug.js",function(b){b.getDebugger().println(a);if(b.isVisible()){return;}b.show();},true);}function HtmlElementFactory(b,a){this.wnd=b?b:window;this.doc=this.wnd.document;this.eparent=typeof(a)=="string"?this.doc.getElementById(a):(typeof(a)=="object"?a:null);this.disabledRecord(false);}HtmlElementFactory.prototype.dispose=function(){this._disposeDoms();this.doc=null;this.wnd=null;};HtmlElementFactory.prototype._disposeDoms=function(){if(!this._buf){return;}var a;while(this._buf.length>0){a=this._buf.pop();if(a.dispose){a.dispose();}}this._buf=null;};HtmlElementFactory.prototype.disabledRecord=function(a){if(a){this._buf=null;}else{if(!this._buf){this._buf=[];}}};function _HtmlElementFactory$SetCaption(a){setTextContent(this,a?a:"");}function _HtmlElementFactory$SetColor(a){this.style.color=a;}function _HtmlElementFactory$SetVisible(b){if(typeof(b)!="boolean"){b=false;}var a=b?"":"none";if(this.style.display==a){return;}this.style.display=a;}function _HtmlElementFactory$Resize(a,b){this.style.cssText+="; width: "+toPerNumber(a)+"; height: "+toPerNumber(b);}function _HtmlElementFactory$SetSrc(a){this.src=a;}function _HtmlElementFactory$GetSrc(){return this.src;}function _HtmlElementFactory$SetDisabled(a,b){if(typeof(a)!="boolean"){a=false;}if(!b){b=this;}if(b.disabled==a){return;}b.disabled=a;}function _HtmlElementFactory$SetDisabled2(a){_HtmlElementFactory$SetDisabled(a,this);this.className=this.className.replace(/ ?(elementDisabled|elementEnabled)/g,"")+(a?" elementDisabled":" elementEnabled");}function _HtmlElementFactory$GetValue(){return this.value;}function _HtmlElementFactory$SetValue(a){this.value=a?a:"";}function _HtmlElementFactory$ClearOption(){for(var a=this.getCount()-1;a>-1;a--){this.removeOption(a);}}function _HtmlElementFactory$AddOption(a,c){if(this.findOption(a,false)==-1){var b=this.ownerDocument.createElement("option");b.value=a;b.text=c;b.title=c;this.options.add(b);return b;}}function _HtmlElementFactory$AddOptions(c){if(!isArray(c)){return;}var b;for(var a=0;a<c.length;a++){b=c[a];if(!isArray(b)){this.addOption(b,b);continue;}if(b.length==1){this.addOption(b[0],b[0]);}else{if(b.length>=2){this.addOption(b[0],b[1]);}}}}function _HtmlElementFactory$RemoveOption(a,b){if(typeof(a)=="string"){a=this.findOption(a,b);}if(typeof(a)=="number"&&a!=-1){this.remove(a);}}function _HtmlElementFactory$GetCount(){return this.options.length;}function _HtmlElementFactory$GetOption(a,b){if(typeof(a)=="string"){a=this.findOption(a,b);}if(typeof(a)=="number"&&a!=-1){return this.options[a];}}function _HtmlElementFactory$SetSelected(a,c){if(typeof(a)=="string"){if(!c&&this.value==a){return;}a=this.findOption(a,c);}if(typeof(a)=="number"&&a!=-1){var b=this.options[a];if(b){b.selected=true;return true;}}return false;}function _HtmlElementFactory$FindOption(d,e){e=typeof(e)=="boolean"?e:true;var c=this.options.length;var b=null;for(var a=0;a<c;a++){b=this.options[a];if(e?b.text==d:b.value==d){return a;}}return -1;}function _HtmlElementFactory$GetCurrentOption(){for(var a=0;a<this.options.length;a++){if(this.options[a].selected){return this.options[a];}}return null;}function _HtmlElementFactory$GetValue4Combobox(){var a=this.getCurrentOption();return a?a.value:"";}function _HtmlElementFactory$SetValue4Combobox(a){this.setSelected(a,false);}function _HtmlElementFactory$GetCaption4Combobox(){var a=this.getCurrentOption();return a?a.text:"";}function _HtmlElementFactory$SetCaption4Combobox(a){this.setSelected(a,true);}function _HtmlElementFactory$Form_GetIFrame(){return this.iframe;}function _HtmlElementFactory$SetAction(a){if(!isie){this.setAttribute("action",a);}else{this.action=a;}}function _HtmlElementFactory$GetDocument(){return this.contentWindow.document;}function _HtmlElementFactory$GetBody(){return this.contentWindow.document.body;}function _HtmlElementFactory$Link_SetCaption(d){var b=this.firstChild;var a=b.nodeType==3?b:b.nextSibling;a.nodeValue=d;}function _HtmlElementFactory$Link_SetImage(b){var a=this.firstChild;if(a.nodeType==1&&a.tagName.toLowerCase()=="img"){a.src=b;}}function _HtmlElementFactory$Dispose(){if(this.setVisible){this.setVisible=null;this.removeAttribute("setVisible");}if(this.setDisabled){this.setDisabled=null;this.removeAttribute("setDisabled");}if(this.setCaption){this.setCaption=null;this.removeAttribute("setCaption");}if(typeof(this.dispose)=="function"){this.dispose=null;this.removeAttribute("dispose");}}function _HtmlElementFactory$EditDispose(){if(this.setDisabled){this.setDisabled=null;this.removeAttribute("setDisabled");}if(this.setValue){this.setValue=null;this.removeAttribute("setValue");}if(this.getValue){this.getValue=null;this.removeAttribute("getValue");}if(typeof(this.dispose)=="function"){this.dispose=null;this.removeAttribute("dispose");}}function _HtmlElementFactory$AddlinkDispose(){if(this.setCaption){this.setCaption=null;this.removeAttribute("setCaption");}if(this.setColor){this.setColor=null;this.removeAttribute("setColor");}if(this.setImage){this.setImage=null;this.removeAttribute("setImage");}if(typeof(this.dispose)=="function"){this.dispose=null;this.removeAttribute("dispose");}}function _HtmlElementFactory$ImgDispose(){if(this.setImg){this.setImg=null;this.removeAttribute("setImg");}if(this.getImg){this.getImg=null;this.removeAttribute("getImg");}if(this.resize){this.resize=null;this.removeAttribute("resize");}if(typeof(this.dispose)=="function"){this.dispose=null;this.removeAttribute("dispose");}}function _HtmlElementFactory$IframeDispose(){if(this.getBody){this.getBody=null;this.removeAttribute("getBody");}if(this.getDocument){this.getDocument=null;this.removeAttribute("getDocument");}if(typeof(this.visible)=="function"){this.visible=null;this.removeAttribute("visible");}if(typeof(this.url)=="function"){this.url=null;this.removeAttribute("url");}if(typeof(this.size)=="function"){this.size=null;this.removeAttribute("size");}if(typeof(this.dispose)=="function"){this.dispose=null;this.removeAttribute("dispose");}}function _HtmlElementFactory$FormDispose(){if(this.getIFrame){this.getIFrame=null;this.removeAttribute("getIFrame");}if(this.setAction){this.setAction=null;this.removeAttribute("setAction");}if(this.iframe){this.iframe.dispose();this.iframe=null;this.removeAttribute("iframe");}if(typeof(this.dispose)=="function"){this.dispose=null;this.removeAttribute("dispose");}}function _HtmlElementFactory$ComboboxDispose(){if(this.clearOption){this.clearOption=null;this.removeAttribute("clearOption");}if(this.addOption){this.addOption=null;this.removeAttribute("addOption");}if(this.addOptions){this.addOptions=null;this.removeAttribute("addOptions");}if(this.removeOption){this.removeOption=null;this.removeAttribute("removeOption");}if(this.getCount){this.getCount=null;this.removeAttribute("getCount");}if(this.getOption){this.getOption=null;this.removeAttribute("getOption");}if(this.setSelected){this.setSelected=null;this.removeAttribute("setSelected");}if(this.findOption){this.findOption=null;this.removeAttribute("findOption");}if(this.getCurrentOption){this.getCurrentOption=null;this.removeAttribute("getCurrentOption");}if(typeof(this.dispose)=="function"){this.dispose=null;this.removeAttribute("dispose");}}HtmlElementFactory.prototype._appendChild=function(b){var a=this.eparent?this.eparent.appendChild(b):b;if(this._buf){this._buf.push(a);}return a;};HtmlElementFactory.prototype.addLink=function(img,caption,ptitle,underline){caption=caption?caption:"";ptitle=ptitle?ptitle:"";underline=typeof(underline)=="boolean"?underline:true;var span=this.doc.createElement("span");span.style.paddingLeft="2px";this._appendChild(span);var _link=this._appendChild(this.doc.createElement("a"));_link.isListViewExLink=true;_link.className="html_link";if(!underline){_link.style.textDecoration="none";}var _icon;if(img){_icon=_link.appendChild(this.doc.createElement("img"));_icon.isListViewExLink=true;with(_icon){src=img;border=0;align="absmiddle";title=ptitle;}}var textNode=_link.appendChild(this.doc.createTextNode(caption));_link.setCaption=_HtmlElementFactory$Link_SetCaption;_link.setColor=_HtmlElementFactory$SetColor;_link.setImage=_HtmlElementFactory$Link_SetImage;_link.dispose=_HtmlElementFactory$AddlinkDispose;return _link;};HtmlElementFactory.prototype.table=function(){var a=this._appendChild(this.doc.createElement("table"));a.border=0;a.cellPadding=0;a.cellSpacing=0;return a;};HtmlElementFactory.prototype.div=function(){var a=this._appendChild(this.doc.createElement("div"));a.setVisible=_HtmlElementFactory$SetVisible;a.dispose=_HtmlElementFactory$Dispose;return a;};HtmlElementFactory.prototype.span=function(){return this._appendChild(this.doc.createElement("span"));};HtmlElementFactory.prototype.label=function(a){var b=this._appendChild(this.doc.createElement("label"));b.setCaption=_HtmlElementFactory$SetCaption;b.dispose=_HtmlElementFactory$Dispose;b.setCaption(a);return b;};HtmlElementFactory.prototype.img=function(){var a=this._appendChild(this.doc.createElement("img"));a.setImg=_HtmlElementFactory$SetSrc;a.getImg=_HtmlElementFactory$GetSrc;a.resize=_HtmlElementFactory$Resize;a.dispose=_HtmlElementFactory$ImgDispose;return a;};HtmlElementFactory.prototype.space=function(){var a=this._appendChild(this.doc.createElement("nobr"));a.className="html_space";return a;};HtmlElementFactory.prototype.file=function(){var a=this._appendChild(inputElement(this.doc,"file"));if(!a){return;}a.setDisabled=_HtmlElementFactory$SetDisabled;a.dispose=_HtmlElementFactory$Dispose;return a;};HtmlElementFactory.prototype.fileinput=function(b,a,h,f,i){var j=this.doc.createElement("div");var b=b||"file";var a=a||"file";if(typeof f!="boolean"){f=true;}h=f?(h||I18N.getString("xui.util.js.45","选择文件")):"";j.innerHTML=h?h+":":"";j.className=f?"html_file_con":"html_importing_content";var d=j.appendChild(this.doc.createElement("div"));d.className=f?"medium_tableright html_file_con2":"html_file_con2";if(isie7){d.style.cssText+="; height: 21px; zoom: 1;";}var g=d.appendChild(inputElement(this.doc,"text"));g.className=f?"filepath_area":"filepath_content";g.readOnly="true";g=d.appendChild(this.doc.createElement("div"));g.className=f?"html_file_con3":"html_file_content";g.title=h;var e=g.appendChild(this.doc.createElement("img"));e.className="html_file_img";e.src=sys.getImgPath("add.gif");var c=g.appendChild(inputElement(this.doc,"file"));c.title=h;c.id=b;c.name=a;c.className="html_file";var k=i&&i.appendChild?i.appendChild(j):this._appendChild(j);c.onchange=function(){c.parentNode.previousSibling.value=this.value;};k.setDisabled=_HtmlElementFactory$SetDisabled;k.dispose=_HtmlElementFactory$Dispose;return c;};HtmlElementFactory.prototype.edit=function(a,b){var c=this._appendChild(inputElement(this.doc,"text",b,a));if(!c){return;}c.className="html_edit";c.setDisabled=_HtmlElementFactory$SetDisabled2;c.getValue=_HtmlElementFactory$GetValue;c.setValue=_HtmlElementFactory$SetValue;c.dispose=_HtmlElementFactory$EditDispose;return c;};HtmlElementFactory.prototype.hidden=function(a,b){return this._appendChild(inputElement(this.doc,"hidden",b,a));};HtmlElementFactory.prototype.password=function(a,b){var c=this._appendChild(inputElement(this.doc,"password",b,a));if(!c){return;}c.className="html_password";c.setDisabled=_HtmlElementFactory$SetDisabled2;c.dispose=_HtmlElementFactory$Dispose;return c;};HtmlElementFactory.prototype.checkbox=function(b,d,a){var c=this._appendChild(inputElement(this.doc,"checkbox",b,d,a));c.className="UICheckbox";c.setDisabled=_HtmlElementFactory$SetDisabled;c.dispose=_HtmlElementFactory$Dispose;return c;};HtmlElementFactory.prototype.radio=function(b,d,a){var c=this._appendChild(inputElement(this.doc,"radio",b,d,a));c.className="UIRadio";c.setDisabled=_HtmlElementFactory$SetDisabled;c.dispose=_HtmlElementFactory$Dispose;return c;};HtmlElementFactory.prototype.textarea=function(a,b){var d="Textarea$"+Math.floor(Math.random()*99999999);var c=this._appendChild(this.doc.createElement("textarea"));c.setAttribute("name",b?b:d);c.setAttribute("id",d);c.value=a?a:"";c.className="html_textarea";c.setDisabled=_HtmlElementFactory$SetDisabled2;c.dispose=_HtmlElementFactory$Dispose;return c;};HtmlElementFactory.prototype.form=function(b,g,a,d,f,j){var k=null;var c=null;b=typeof(b)=="string"?b:null;var h="Form$"+Math.floor(Math.random()*99999999);if(typeof(f)=="boolean"){if(f){k=this.iframe(j);k.size(0,0);c=k.name;}}else{if(typeof(f)=="string"){c=f;}}var i=this.doc.createElement("div"),e=['<form style="margin: 0px; padding: 0px; *zoom:1;" method="'+(a||"post")+'" name="'+(b||h)+'" id="'+h+'" '];if(d){e.push('action="'+d+'" ');}if(g){e.push('enctype="'+g+'" ');}if(c){e.push('target="'+c+'" ');}e.push("/>");i.innerHTML=e.join("");var l=i.firstChild;if(k){l.appendChild(k);l.iframe=k;}this._appendChild(l);l.getIFrame=_HtmlElementFactory$Form_GetIFrame;l.setAction=_HtmlElementFactory$SetAction;l.dispose=_HtmlElementFactory$FormDispose;return l;};HtmlElementFactory.prototype.image=function(b){var a=this._appendChild(this.doc.createElement("img"));if(b){a.src=b;}return a;};HtmlElementFactory.prototype.combobox=function(){var b=this.doc;var a=this._appendChild(b.createElement("select"));a.style.fontSize="12px";a.clearOption=_HtmlElementFactory$ClearOption;a.addOption=_HtmlElementFactory$AddOption;a.addOptions=_HtmlElementFactory$AddOptions;a.removeOption=_HtmlElementFactory$RemoveOption;a.getCount=_HtmlElementFactory$GetCount;a.getOption=_HtmlElementFactory$GetOption;a.setSelected=_HtmlElementFactory$SetSelected;a.findOption=_HtmlElementFactory$FindOption;a.getCurrentOption=_HtmlElementFactory$GetCurrentOption;a.setDisabled=_HtmlElementFactory$SetDisabled;a.getValue=_HtmlElementFactory$GetValue4Combobox;a.setValue=_HtmlElementFactory$SetValue4Combobox;a.getCaption=_HtmlElementFactory$GetCaption4Combobox;a.setCaption=_HtmlElementFactory$SetCaption4Combobox;a.dispose=_HtmlElementFactory$ComboboxDispose;return a;};HtmlElementFactory.prototype.button=function(caption){var bt=this._appendChild(inputElement(this.doc,"button",null,caption?caption:""));with(bt.style){fontSize="12px";borderWidth=0;}bt.setDisabled=_HtmlElementFactory$SetDisabled;bt.dispose=_HtmlElementFactory$Dispose;return bt;};HtmlElementFactory.prototype.button2=function(b){var a=Button.create(this.wnd,null,b);if(this._buf){this._buf.push(a);}this._appendChild(a.getContainer());return a;};HtmlElementFactory.prototype.iframe=function(d){var c="Iframe$"+Math.floor(Math.random()*99999999);var a=this.doc.createElement("div");a.innerHTML='<iframe name="'+c+'" id="'+c+'" frameborder="0" marginheight="0" marginwidth="0" style="width: 100%; height: 100%; margin: 0; border: none"'+"/>";var b=a.firstChild;this._appendChild(b);b.size=_HtmlElementFactory$Resize;b.url=_HtmlElementFactory$SetSrc;b.visible=_HtmlElementFactory$SetVisible;b.getDocument=_HtmlElementFactory$GetDocument;b.getBody=_HtmlElementFactory$GetBody;b.dispose=_HtmlElementFactory$IframeDispose;if(typeof(d)=="function"){if(!b._callbackFunc){b._callbackFunc=function(){d(b);};}if(b.attachEvent){b.attachEvent("onload",b._callbackFunc);}else{b.onload=b._callbackFunc;}}return b;};HtmlElementFactory.prototype._separator=function(a,b){var c=this.doc.createElement("hr");c.size=1;c.noShade=true;if(typeof(b)=="number"){c.style.width=b+"px";}else{if(typeof(b)=="string"){if(b.lastIndexOf("%")!=-1){c.style.width=b;}else{c.style.width=b+"px";}}else{c.style.width="100%";}}return a?a.appendChild(c):c;};HtmlElementFactory.prototype.separator=function(caption){if(caption){var obj=this._appendChild(this.doc.createElement("table"));with(obj){border=0;width="100%";cellPadding=0;cellSpacing=0;}var line=obj.insertRow(-1);var t0=line.insertCell(-1);t0.width="1%";t0.noWrap=true;this._separator(t0,10);var t1=line.insertCell(-1);t1.width="1%";t1.noWrap=true;t1.style.fontSize="12px";t1.style.padding="0 4px 0";if(typeof(caption)=="object"){t1.appendChild(caption);}else{t1.innerHTML=caption?caption:"&nbsp;";}var t2=line.insertCell(-1);t2.width="98%";this._separator(t2);return obj;}return this._separator(this.eparent);};HtmlElementFactory.prototype.textnode=function(a){return this._appendChild(this.doc.createTextNode(a));};HtmlElementFactory.prototype.textnote=HtmlElementFactory.prototype.textnode;function queryObj(c,b){var a=QueryObj.create(c,b,null,null,false);a.checkResult();return a.getDetail();}function queryXml(c,b){var a=QueryObj.create(c,b,null,null,false);a.checkResult();return a.getResponseXML();}function QueryObj(e,d,b,a,c){if(typeof(c)!="boolean"){c=true;}this.async=b!=null;this.userdata=a;this.url=this._formatUrl(e);this.params=d;this.onfinish=b;this.autodispose=c;this._sendRequest();}QueryObj.create=function(e,d,b,a,c){return new QueryObj(e,d,b,a,c);};QueryObj.prototype.dispose=function(){this.onfinish=null;if(this.userdata){delete this.userdata;}if(this.hp){try{if(typeof(this.hp.onreadystatechange)!="unknown"){this.hp.onreadystatechange=null;}}catch(a){}this.hp=null;}};QueryObj.prototype.abort=function(){this.hp.onreadystatechange=isie6?function(){}:null;this.hp.abort();};QueryObj.prototype._retry=function(){if(!this._retrytimes){this._retrytimes=0;}if(this._retrytimes++<=2){this.abort();var a=this;setTimeout(function(){a._sendRequest();},1);return true;}return false;};QueryObj.prototype._startTimeoutTimer=function(){if(!isie6){return;}this._clearTimeoutTimer();var a=this;this._timeout_check_handle=setTimeout(function(){a._timeout_check_handle=0;if(a._lastReadyState<=1){a._retry();}},1000*30);};QueryObj.prototype._clearTimeoutTimer=function(){if(this._timeout_check_handle){clearTimeout(this._timeout_check_handle);this._timeout_check_handle=0;}};QueryObj.prototype._onreadystatechange=function(){this._lastReadyState=this.hp.readyState;if(this.hp.readyState==4){this._clearTimeoutTimer();if(this.hp.status==undefined||this.hp.status==0||this.hp.status>12000){if(this._retry()){return;}}var onfinish=this.onfinish;if(typeof(onfinish)=="function"){onfinish(this,this.userdata);}else{eval(onfinish);}if(this.autodispose){this.dispose();}}};QueryObj.prototype._sendRequest=function(){this.hp=xmlhttp();this._lastReadyState=0;var d=this.params;var b=this.async;var c=this.autodispose;if(b){this._startTimeoutTimer();var a=this;this.hp.onreadystatechange=function(){a._onreadystatechange();};}this.hp.open((d)?"POST":"GET",this.url,this.async);if(isie&&!isie6){this.hp.setRequestHeader("Connection","close");}this.hp.setRequestHeader("X_REQUESTED_WITH","XMLHttpRequest");if(d){this.hp.setRequestHeader("CONTENT-TYPE","application/x-www-form-urlencoded;charset=utf-8");this.hp.send(this._makeParams());}else{this.hp.send(null);}if(!b&&(this.hp.getResponseHeader("SANLINK-DATA-LENGTH")||this.hp.getResponseHeader("ESEN-DATA-LENGTH"))){this._parseResult();if(c){this.dispose();}}};QueryObj.prototype._formatUrl=formatUrl;QueryObj.prototype.checkHttpResult=function(){var d=this.hp;var a;try{if(d.status!==undefined&&d.status!==0){a=d.status;}else{a=13030;}}catch(g){a=13030;}if(!(a>=200&&a<300||a===1223)){var c="";var f="";try{c=d.responseText;}catch(b){}try{f=d.statusText;}catch(b){}if(a>=12000||a==0){throwError(I18N.getString("xui.util.js.31","无法访问服务器，服务器可能已经停止！"),"\r\n"+this.url,null,null,a);return;}if(a==500){throwError(I18N.getString("xui.util.js.32","服务器端发生异常！")+"\r\n"+this.url,c,null,a);return;}if(a==401){throwError(I18N.getString("xui.ctrls.xdialog.js.unauthorizederror","您没有权限或者登录超时。请重新登录!"),null,null,a);return;}throwError(I18N.getString("xui.util.js.33","当请求url:{0} 时服务器返回错误状态:",[this.url])+"\r\n"+a+" "+f,c,null,a);}};QueryObj.prototype._parseResult=function(){this.resultparsed=true;this.checkHttpResult();this._result=this.hp.getResponseHeader("X-ESEN-HEADER-RESULT");if(!this._result){this._result="OK";}this._message=unescape(this.hp.getResponseHeader("X-ESEN-HEADER-MESSAGE"));this._javascript=unescape(this.hp.getResponseHeader("X-ESEN-HEADER-JS"));if(this.isResultException()){this._exception=this.hp.responseText;}var a=unescape(this.hp.getResponseHeader("X-ESEN-HEADER-EXCEPTIONCLASSNAME"));if(a){this._option="rootExceptionClass="+a;}};QueryObj.prototype.isResultOk=function(){return this._result=="OK";};QueryObj.prototype.isResultException=function(){return this._result=="EXCEPTION";};QueryObj.prototype.isResultError=function(){return this._result=="ERROR";};QueryObj.prototype.getMessage=function(){return this._message;};QueryObj.prototype.getException=function(){return this._exception;};QueryObj.prototype.getDetail=function(){return this.getResponseText();};QueryObj.prototype.getResponseXML=function(){var a=this.hp.responseXML;return a;};QueryObj.prototype.getResponseJSON=function(){var a=this.getResponseText();return a?JSON.parse(a):null;};QueryObj.prototype.getResponseText=function(){return this.hp.responseText;};QueryObj.prototype._makeParams=function(){var a=this.params;if(!a){return null;}if(isString(a)){return encodeURI(a);}else{if(a.export2uri){return a.export2uri();}else{throwError(I18N.getString("xui.util.js.2","queryObj方法的params只能为null，string，HashMap或StringMap"));}}};QueryObj.prototype.checkResult=function(){if(!this.resultparsed){this._parseResult();}if(this._javascript){eval(this._javascript);}if(!this.isResultOk()){var params=this._makeParams();var paramsStr=(params?"?"+params:"");if(paramsStr.length>1000){paramsStr=paramsStr.substring(0,1000);}var detailmsg="QueryObj ERROR:"+this.url+paramsStr+"\r\n"+this.getException();throwError(this.getMessage(),detailmsg,this._option);}};include("xui/i18n.js");function AbstractReqObj(){if(_biInPrototype){return;}this.wnd=window;this.options=new Map();}AbstractReqObj.prototype.setProperty=function(a,b){this.options.put(a,b);};AbstractReqObj.prototype.addProperties=function(a){if(!a){return;}if(typeof(a)=="string"){a=new Map(a,";");}this.options.putMap(a);};AbstractReqObj.prototype.getProperty=function(a,b){return this.options.get(a,b);};AbstractReqObj.prototype.start=function(){this.asynStart();};AbstractReqObj.prototype.query=function(){if(this.isCanceled()){return;}var a=new Map();a.put("action","query");if(this.status){this.status.setQueryParams(a);}this.asynQuery(a);};AbstractReqObj.prototype.asynQuery=function(a){};AbstractReqObj.prototype.cancel=function(){if(this.isCanceled()){return;}this._canceled=true;var a=new Map();a.put("action","cancel");if(this.status){this.status.setQueryParams(a);}this.asynQuery(a);};AbstractReqObj.prototype.isCanceled=function(){return this._canceled?true:false;};AbstractReqObj.prototype.getId=function(){return this._id;};AbstractReqObj.prototype.setId=function(a){this._id=a;};AbstractReqObj.prototype.getStatusStr=function(){if(!this.status){return I18N.getString("xui.util.js.36","执行未开始");}else{if(this.status.isFinished()){return I18N.getString("xui.util.js.37","执行完毕");}else{if(this.status.isCanceled()){return I18N.getString("xui.util.js.38","执行取消");}else{if(this.status.isWaiting()){return I18N.getString("xui.util.js.39","正在等待执行...");}else{return I18N.getString("xui.util.js.40","正在执行...");}}}}};AbstractReqObj.prototype.showError=function(a){if(typeof(showError)=="function"){showError(a);}else{alert(isie?a.description:a.message);}};AbstractReqObj.prototype.onqueryobjfinish=function(c){try{c.checkResult();}catch(e){if(this.finishWithError){this.finishWithError(e);}if(!c.isResultException()&&!c.isResultError()){this.showError(e);return;}}this._loadStatus(c.getDetail());var a=this.status;if(c.isResultException()||c.isResultError()){try{var b=a.getLogs();if(!b){b=c.getDetail();}b+=I18N.getString("xui.util.js.41","\r\n\r\n页面地址为：【{0}】",["<a errurl=true>"+c.url+(c.params?"?"+c.params:"")+"</a>"]);throwError(c.getMessage(),b);}catch(d){if(!isMobile){this.showError(d);}}return;}if(!this._id){this._id=this.status.getId();if(!this._id){throwError(I18N.getString("xui.util.js.43","提交计算请求后无法从服务器获得id"));}if(!a.isFinished()&&this.isCanceled()){this.cancel();}}if(this.showStatus){this.showStatus();}this.querynext();};AbstractReqObj.prototype.querynext=function(){var a=this.status;if(a.isFinished()||this.isCanceled()){this.finish();}else{this.timerid=mySetTimeout(this.wnd,new CallBackFunc(this,this.query),this.getTimeInterval());}};AbstractReqObj.prototype.getTimeInterval=function(){if(typeof(this.timeInterval)=="undefined"){this.timeInterval=500;}if(this.timeInterval>=505&&this.timeInterval<1000*2){this.timeInterval+=500;}else{this.timeInterval+=1;}return this.timeInterval;};function _AbstractReqObj_onQueryFinish(b,a){a.onqueryobjfinish(b);}AbstractReqObj.prototype.queryserver=function(a,b){if(b==null){b="";}if(this.getId()){if(typeof(b)=="string"){b+=("&id="+this.getId());}else{b.put("id",this.getId());}}QueryObj.create(a,b,_AbstractReqObj_onQueryFinish,this);};AbstractReqObj.prototype._loadStatus=function(a){if(!this.status){this.status=new ReqObjExeStatus();}this.status._load(a);};AbstractReqObj.prototype.reset=function(){this._canceled=false;this._id=null;this.options.clear();if(this.status){this.status.reset();}};function ReqObjExeStatus(){this._logs="";}ReqObjExeStatus.prototype._load=function(d){var f=new StringMap(d,"\r\n");this._status=f.getValue("status");this._hasException=f.getValue("hasexception")=="true";this._exceptionmsg=unescape(f.getValue("exceptionmsg"));this._startTime=f.getValue("starttime");if(!this._caclId){this._caclId=f.getValue("id");}this._canceled=f.getValue("canceled");this._resultIsReport=f.getValue("reportresult")!="false";var a=f.getValue("logscount");if(a){this.logscount=a;}var e=f.getValue("lastlog");if(typeof(e)=="string"&&this._logs){this._logs=this._logs.substring(0,this._logs.length-this.lastlog_len-2)+unescape(e)+"\r\n";}var b=f.getValue("lastlog_hash");if(b){this.lastlog_hash=b;this.lastlog_len=parseInt(f.getValue("lastlog_len"));}var c=f.getValue("inclogs");if(c){if(this._logs){this._logs=this._logs+unescape(c);}else{this._logs=unescape(c);}}this.options=f;};ReqObjExeStatus.prototype.setQueryParams=function(a){if(this.logscount){a.put("last_getlogs_count",this.logscount);}if(this.lastlog_hash){a.put("lastlog_hash",this.lastlog_hash);}};ReqObjExeStatus.prototype.resultIsReport=function(){return this._resultIsReport;};ReqObjExeStatus.prototype.isWaiting=function(){return this._status=="waiting";};ReqObjExeStatus.prototype.isExecuting=function(){return this._status=="executing";};ReqObjExeStatus.prototype.isFinished=function(){return this._status=="finished";};ReqObjExeStatus.prototype.hasException=function(){return this._hasException;};ReqObjExeStatus.prototype.getExceptionMsg=function(){return this._exceptionmsg;};ReqObjExeStatus.prototype.isCanceled=function(){return this._canceled=="true";};ReqObjExeStatus.prototype.getRequestStartTime=function(){return this._startTime;};ReqObjExeStatus.prototype.getLogs=function(){return this._logs;};ReqObjExeStatus.prototype.getId=function(){return this._caclId;};ReqObjExeStatus.prototype.getOwner=function(){return null;};ReqObjExeStatus.prototype.getProgress=function(){return null;};ReqObjExeStatus.prototype.getOptions=function(){return this.options;};ReqObjExeStatus.prototype.reset=function(){this.options.clear();this._caclId=null;this._logs=null;this._canceled=false;this._hasException=false;this._resultIsReport=false;this._startTime=false;};function getLeftTree(){var b=0;var a=window;while(b++<4){var c=a.__esen_bi_lefttree;if(c){return c;}a=a.parent;}}function refreshLeftTree(){var a=getLeftTree();if(a){a.refresh();}}function getWorkspace(){var b=0;var a=window;while(b++<4){var c=a.__esen_bi_workspace;if(c){return c;}a=a.parent;}}function closeWindow(c,b){if(!c||!c.navigator){c=window;}var a=getWorkspace();if(a){a.closeCurrentPage(b,c);}else{autoCloseBrowser(c);}}function AutoPlay(b,a){this.wnd=b&&b.document?b:window;this.doc=this.wnd.document;this.setDelay(a);}AutoPlay.prototype.dispose=function(){this.__userdata=null;this.stop();this._autoCallback=null;this.wnd=null;this.doc=null;};AutoPlay.prototype.toString=function(){return"AutoPlay";};AutoPlay.prototype.setDelay=function(a){this.delay=typeof(a)=="number"?(a*1000):(15*60*1000);};AutoPlay.prototype.stop=function(){if(this.autoPlayTimer){this.wnd.clearTimeout(this.autoPlayTimer);}};AutoPlay.prototype.setAutoCallback=function(a){this._autoCallback=a;};AutoPlay.prototype.play=function(a){this.autoPlayTimer=this.wnd.setTimeout(this._func_AutoPlay_callback.bind(this),typeof(a)=="number"?(a*1000):this.delay);};AutoPlay.prototype._func_AutoPlay_callback=function(){if(typeof(this._autoCallback)=="function"){this._autoCallback(this,this.__userdata);}this.stop();this.play();};function Download(b,a){this.wnd=b&&b.document?b:window;this.doc=this.wnd.document;this.url=a;this._initDownload();}Download.create=function(d,c,b){var a=new Download(d,c);if(typeof(b)!="boolean"){b=false;}if(b){addDispose(a);}return a;};Download.getInstance=function(){return getObjectFromRoot("Download","__DownloadInstance__",true,"xui/util.js");};Download.prototype.dispose=function(){this.wnd=null;this.doc=null;if(this._downloadAttachForm){this.doc.removeChild(this._downloadAttachForm);this._downloadAttachForm=null;}};Download.prototype._initDownload=function(){this._downloadAttachForm=new HtmlElementFactory(this.wnd,this.doc.body).form("downloadForm"+Math.floor(Math.random()*9999),null,"post",this.url,true);};Download.prototype.getForm=function(){return this._downloadAttachForm;};Download.prototype.setAction=function(a,b){this._downloadAttachForm.setAction(a);if(typeof(b)!="boolean"){b=false;}if(b){this.submit();}};Download.prototype.submit=function(){this._downloadAttachForm.submit();};function viewDbResource(b,c){var a=getWorkspace();var d="dbmgr.do?action=page&path=location&escape=true&dsname="+escapeURIComponent(b)+"&tablename="+escapeURIComponent(c);a.showURL(d);}function CallBackFunc(a,b){if(typeof(a)=="object"&&typeof(b)=="function"){this.clsinstance=a;this.method=b;}else{if(typeof(a)=="string"){this.exestr=a;}else{if(typeof(a)=="function"){this.method=b;}else{throwError(I18N.getString("xui.util.js.19","传递给函数CallBackFunc的参数不正确"));}}}}function getDomValue(a){switch(a.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":return a.value;case"DIV":case"TD":case"A":case"SPAN":case"NOBR":return getTextContent(a);case"SELECT":return a.options[a.selectedIndex].text;default:throwError(I18N.getString("xui.util.js.21","不能识别的dom元素"));}}function setDomValue(h,g,d,b){switch(h.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":if(g!=null){h.value=g;}break;case"DIV":case"TD":case"A":case"SPAN":case"NOBR":if(g!=null){if(g==null||g.length==0||g.equalsIgnoreCase("null")){setTextContent(h,"");}else{setTextContent(h,g);}}break;case"SELECT":if(g!=null){if(isNumber(g)){h.selectedIndex=g;}else{var c=h.options;var a=c.length;var f;for(var e=0;e<a;e++){f=c[e];if((b?f.value:f.text)==g){h.selectedIndex=e;break;}}}}break;default:throwError(I18N.getString("xui.util.js.11","不能识别的dom元素"));}if(isBoolean(d)){h.disabled=!d;}}function OrderMap(c,a,b){if(_biInPrototype){return;}this.arr=new Array();if(arguments.length>0){Map.call(this,c,a,b);}else{Map.call(this);}}_extendClass(OrderMap,Map,"OrderMap");OrderMap.prototype.put=function(a,b){var c=this.size();Map.prototype.put.call(this,a,b);var d=this.size();if(c!=d){this.arr[c]=a;}};OrderMap.prototype.export2str2=function(e,b){var a=new Array();for(var d=0;d<this.size();d++){var c=this.getKey(d);if(isUndefined(c)){continue;}if(e){a.push(c);}else{a.push(this.get(c));}}return a.join(b?b:";");};OrderMap.prototype.getByIndex=function(a){return Map.prototype.get.call(this,this.arr[a]);};OrderMap.prototype.get=function(a){if(isNumber(a)){return this.getByIndex(a);}else{if(isString(a)){return Map.prototype.get.call(this,a);}else{return null;}}};OrderMap.prototype.remove=function(c){if(isNumber(c)){if(c>this.arr.length){throwError(I18N.getString("xui.util.js.3","Map中的数组越界"));}var b=this.arr[c];Map.prototype.remove.call(this,b);this.arr.splice(c,1);}else{if(isString(c)){if(this.contains(c)){Map.prototype.remove.call(this,c);var a=this.getKeyIndex(c);if(a==-1){throwError(I18N.getString("xui.util.js.4","map中存在，记录关键字的数组中不存在！"));}this.arr.splice(a,1);}}}return true;};OrderMap.prototype.getKey=function(a){return this.arr[a];};OrderMap.prototype.key2str=function(a){return this.arr.join(a);};OrderMap.prototype.clear=function(){Map.prototype.clear.call(this);this.arr.splice(0,this.arr.length);};OrderMap.prototype.getKeyIndex=function(b){for(var a=0;a<this.arr.length;a++){if(this.arr[a]==b){return a;}}return -1;};function formatUrl(b){if(/^http(s)?:/g.test(b)){return b;}if(b.indexOf("../")==0||b.indexOf("/")==-1){var d=window.location.pathname;var c=d.lastIndexOf("/");if(c>=0){return d.substring(0,c+1)+b;}}var a=sys.getContextPath();if(a!="/"&&b.indexOf(a)==0){return b;}b=b.replace(new RegExp("^/+"),"");return a+b;}var MONTH_NAMES=new Array("一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");var DAY_NAMES=new Array(I18N.getString("XUI.COMMON.SUN","星期日"),I18N.getString("XUI.COMMON.MON","星期一"),I18N.getString("XUI.COMMON.TUES","星期二"),I18N.getString("XUI.COMMON.WED","星期三"),I18N.getString("XUI.COMMON.THURS","星期四"),I18N.getString("XUI.COMMON.FRI","星期五"),I18N.getString("XUI.COMMON.SAT","星期六"),I18N.getString("xui.util.js.12","日"),I18N.getString("xui.util.js.13","一"),I18N.getString("xui.util.js.14","二"),I18N.getString("xui.util.js.15","三"),I18N.getString("xui.util.js.16","四"),I18N.getString("xui.util.js.17","五"),I18N.getString("xui.util.js.18","六"));function formatDate(I,D){D=D+"";var l="";var v=0;var G="";var f="";var j=I.getFullYear()+"";var g=I.getMonth()+1;var F=I.getDate();var o=I.getDay();var n=I.getHours();var x=I.getMinutes();var q=I.getSeconds();var t,u,b,r,J,e,C,B,z,p,N,n,L,i,a,A;var w={};w["y"]=""+j;w["yyyy"]=j;w["yy"]=j.substring(2,4);w["M"]=g;w["MM"]=LZ(g);w["MMM"]=MONTH_NAMES[g-1];w["NNN"]=MONTH_NAMES[g+11];w["d"]=F;w["dd"]=LZ(F);w["E"]=DAY_NAMES[o+7];w["EE"]=DAY_NAMES[o];w["H"]=n;w["HH"]=LZ(n);if(n==0){w["h"]=12;}else{if(n>12){w["h"]=n-12;}else{w["h"]=n;}}w["hh"]=LZ(w["h"]);if(n>11){w["K"]=n-12;}else{w["K"]=n;}w["k"]=n+1;w["KK"]=LZ(w["K"]);w["kk"]=LZ(w["k"]);if(n>11){w["a"]="PM";}else{w["a"]="AM";}w["m"]=x;w["mm"]=LZ(x);w["s"]=q;w["ss"]=LZ(q);while(v<D.length){G=D.charAt(v);f="";while((D.charAt(v)==G)&&(v<D.length)){f+=D.charAt(v++);}if(w[f]!=null){l=l+w[f];}else{l=l+f;}}return l;}function formatTime(d){if(d<60*1000){return(I18N.getString("xui.util.js.42","1分钟"));}else{if(60*1000<=d&&d<60*60*1000){var c=Math.floor(d/(60*1000));return(I18N.getString("xui.util.js.34","{0}分钟",[c]));}else{if(60*60*1000<=d&&d<24*60*60*1000){var c=Math.floor(d/(60*1000));var b=Math.floor(c/60);if(c%60==0){return(I18N.getString("xui.util.js.55","{0}小时",[b]));}else{return(I18N.getString("xui.util.js.56","{0}小时{1}分钟",[b,c%60]));}}else{if(24*60*60*1000<=d&&d<30*24*60*60*1000){var c=Math.floor(d/(60*60*1000));var b=Math.floor(c/24);if(c%24==0){return(I18N.getString("xui.util.js.57","{0}天",[b]));}else{return(I18N.getString("xui.util.js.58","{0}天{1}小时",[b,c%24]));}}else{var c=Math.floor(d/(24*60*60*1000));var b=Math.floor(c/30);if(c%30==0){return(I18N.getString("xui.util.js.59","{0}月",[b]));}else{return(I18N.getString("xui.util.js.46","{0}月{1}天",[b,c%30]));}}}}}}function getCurrentDate(){var a=new Date();var b=[I18N.getString("xui.util.js.12","日"),I18N.getString("xui.util.js.13","一"),I18N.getString("xui.util.js.14","二"),I18N.getString("xui.util.js.15","三"),I18N.getString("xui.util.js.16","四"),I18N.getString("xui.util.js.17","五"),I18N.getString("xui.util.js.18","六")];return a.toLocaleString()+I18N.getString("XUI.COMMON.WEEKDAY","星期")+b[a.getDay()];}function showWaitDialog(b){var a=getRootWindow();a.__ESEN$WaitDialog$IsVisible__=true;getDefaultWaitDialog(function(c){if(a.__ESEN$WaitDialog$IsVisible__){if(a.__ESEN$WaitDialog$Timeout__){a.clearTimeout(a.__ESEN$WaitDialog$Timeout__);a.__ESEN$WaitDialog$Timeout__=false;}b=b?b:I18N.getString("xui.util.js.20","正在装入，请等待…");c.setCanResizable(false);c.setParams(b);c.show();}});}function getHelp(a,c,b){if(!a){return;}getObjectFromRootAsync("MemoDialog","__ESEN$HelpDialog__",true,"xdialog",function(d){d.setContent((a.indexOf("vfs/")==0?sys.getContextPath():"")+a,true);d.open(b);d.setTitle(c,I18N.getString("XUI.COMMON.HELP","帮助"));d.setIcon("xui/images/help.gif");d.moveTo(d.doc.body.clientWidth-(d.getWidth()+5));});}TxtLoader.prototype._canAdd=function(c,b,a){if(b==null){return true;}return(b.contains(c)==a);};TxtLoader.prototype._initFilterMap=function(d){var b=d.split(",");var e=new Map();for(var c=0,a=b.length;c<a;c++){e.put(b[c].toUpperCase(),b[c]);}return e;};TxtLoader.prototype.init=function(){if(this.content==null||this.content.length==0){return;}var g="";var a=false;var h=null;if(this.arglen==3){g=this.args[1];a=this.args[2];h=this._initFilterMap(g);}var k;var j;var b;var e=0;var d=this.content.indexOf("<",e);while(d!=-1){e=this.content.indexOf(">",d);if(e==-1){alert(I18N.getString("xui.util.js.24",'位于第{0}个字符位置的"<"不匹配',[d]));break;}if(this.content.charAt(e-1)=="/"){k=this.content.substring(d,e+1);j=k.substring(d+1,e-1);b=j.indexOf(" ");if(b>-1){j=j.substring(d+1,b);}if(!this._canAdd(j.toUpperCase(),h,a)){d=this.content.indexOf("<",e);continue;}this.sectionArray.push({name:j.toUpperCase(),value:k});d=this.content.indexOf("<",e);continue;}j=this.content.substring(d+1,e);b=j.indexOf(" ");if(b>-1){j=j.substring(0,b);}var l="<"+j;var c="</"+j+">";var f=searchIndex(this.content,l,c,d);if(f==-1){break;}if(!this._canAdd(j.toUpperCase(),h,a)){d=this.content.indexOf("<",f+c.length);continue;}k=this.content.substring(d,f)+c;this.sectionArray.push({name:j.toUpperCase(),value:k});d=this.content.indexOf("<",f+c.length);}};TxtLoader.prototype.getSectionCount=function(){return this.sectionArray.length;};TxtLoader.prototype.getSection=function(d){if(isString(d)){var b=d.toUpperCase();for(var c=0,a=this.sectionArray.length;c<a;c++){if(this.sectionArray[c].name==b){return new TxtSection(this.sectionArray[c].value);}}return null;}else{if(isNumber(d)){return new TxtSection(this.sectionArray[d].value);}else{alert(I18N.getString("xui.util.js.25","{0}输入的参数错误!",[d]));}}};TxtLoader.prototype.getSections=function(d){if(!isString(d)){throwError(I18N.getString("xui.util.js.26","输入的参数错误，这里只识别字符串参数"));}var e=new Array();var b=d.toUpperCase();for(var c=0,a=this.sectionArray.length;c<a;c++){if(this.sectionArray[c].name==b){e.push(new TxtSection(this.sectionArray[c].value));}}return e;};TxtLoader.prototype.toString=function(){return"TxtLoader";};function TxtSection(a){this.content=a;this.name="";this.attribsinit=false;this.attribs="";this.attribsmap=new StringMap(""," ");this.contentStr="";this.strmap=new StringMap("","\r\n");this.strmapinit=false;this.recinit=false;this.txtLoad;this.init();return this;}TxtSection.prototype.init=function(){var e=0;var d=this.content.indexOf("<",e);var e=this.content.indexOf(">",d);var b;var j;if(this.content.charAt(e-1)=="/"){this.contentStr="";b=this.content.substring(d+1,e-1);j=b.indexOf(" ");if((b.length>0)&&(j>-1)){this.name=b.substring(0,j);this.attribs=b.substring(j+1);}else{this.name=b;this.attribs="";}this.contentStr="";return;}var i=this.content.substring(d+1,e);var a=i.indexOf(" ");if(a>0){this.attribs=i.substring(a+1,e);i=i.substring(0,a);}this.name=i;d=searchIndex(this.content,"<"+i,"</"+i+">",0);if(d!=-1){var g="\r\n";var f=this.content.substring(e+1,d);for(var h=0;f.charCodeAt(h)<33;h++){}this.contentStr=f.slice(h);}};TxtSection.prototype.getName=function(){return this.name;};TxtSection.prototype.getAttribs=function(){if(!this.attribsinit){this.attribsmap.merge(this.attribs);}this.attribsinit=true;return this.attribsmap;};TxtSection.prototype.getContents=function(){if(!this.strmapinit){this.strmap.merge(this.contentStr);}this.strmapinit=true;return this.strmap;};TxtSection.prototype.getContentStr=function(){return this.contentStr;};TxtSection.prototype.getSectionCount=function(){if(!this.recinit){this.txtLoad=new TxtLoader(this.contentStr);}this.recinit=true;return this.txtLoad.getSectionCount();};TxtSection.prototype.getSection=function(a){if(!this.recinit){this.txtLoad=new TxtLoader(this.contentStr);}this.recinit=true;return this.txtLoad.getSection(a);};TxtSection.prototype.getSections=function(a){if(!this.recinit){this.txtLoad=new TxtLoader(this.contentStr);}this.recinit=true;return this.txtLoad.getSections(a);};TxtSection.prototype.toString=function(){return"TxtSection";};function searchIndex(j,n,e,h){var k=j.indexOf(e,h);if(k==-1){alert(I18N.getString("xui.util.js.22","没有匹配",[n]));return k;}var f=j.lastIndexOf(n,k);if(f==h){return k;}var l=false;var m=0;f=h;var d=h;while(f>-1){i2=j.indexOf(">",f);var c=j.charAt(i2-1);var a=j.charAt(f+n.length);if(c=="/"||(a!=">"&&a!=" ")){f=j.indexOf(n,i2);continue;}if(f<k){m++;}else{i2=j.lastIndexOf(e,f);k=i2;d=f;while(i2>h&&i2!=-1){m--;if(m==0){l=true;break;}i2=j.lastIndexOf(e,i2-1);}h=f;if(l){break;}else{m++;}k=j.indexOf(e,f);}f=j.indexOf(n,f+1);}if(f==-1){f=d;for(var g=1;g<=m;g++){k=j.indexOf(e,f);f=k+e.length;}}if(k==-1){alert(I18N.getString("xui.util.js.23","没有匹配，检查相同段名的嵌套情况!",[n]));}return k;}function formatColor(d,g){var c=document.createElement("div");var e=window.getComputedStyle?function(){return window.getComputedStyle(c)["color"];}:c.currentStyle?function(){return c.currentStyle["color"];}:function(){return null;};var b=function(h){var i=h.toString(16);return i.length===1?"0"+i:i;};var a=function(h){var i=parseInt(h,10);return("#"+b((i>>16)&255)+b((i>>8)&255)+b(i&255)).toUpperCase();};var f=function(h,i){if(!isNaN(h)||/\d+/.test(h)){return a(h);}else{c.style.color=h;h=e();return h?h.toUpperCase():i;}};formatColor=function(l,n,j){if(!l){return n;}if("transparent"===l){return l;}if(/^#(\d|[a-f]|[A-F]){6}$/.test(l)){return l.toUpperCase();}if(/^#(\d|[a-f]|[A-F]){3}$/.test(l)){return l.replace(/([^#])/g,"$1"+"$1").toUpperCase();}if(/rgb/.test(l)){var o=l.split(",");if(o.length<3){return n;}var h="#",k=null;for(var m=0;m<3;m++){h+=b(parseInt(o[m].replace(/[^\d]/gi,""),10)&255);}return h.toUpperCase();}if(j){return n;}return f(l,n);};return formatColor(d,g);}function showProgressDlg(b,c){var a=progressDialog();a.setMessage(b?b:I18N.getString("xui.util.js.28","正在计算，请稍等......"));a.setLogs("");a.showUnknownProgress();a.setHasDetailButton(false);a.setCanCancel(typeof(c)=="function",c);if(a.isVisible()){return;}a.show();}function getFileContent(b){var a="";var c=xmlhttp();try{c.open("GET",b,false);c.send(null);if(c.status<200||c.status>=400){throwError(I18N.getString("xui.util.js.29","当请求文件:{0} 时服务器返回错误状态:{1} {2}",[b,c.status,c.statusText]));}a=c.responseText;return a;}catch(f){var d=(f.description?f.description:f.message)+I18N.getString("xui.util.js.30","\n脚本''{0}''加载失败!",[b]);throw new Error(d);}}function disableDocTextSelect(a,b){a=a||document.body;b=!!b;if((a.getAttribute("unselectable")==="on")!==b){return false;}if(b){a.removeAttribute("unselectable");a.style.MozUserSelect="";a.style.webkitUserSelect="";a.style.KhtmlUserSelect="";a.style.msUserSelect="";a.onselectstart=null;}else{a.setAttribute("unselectable","on");a.style.MozUserSelect="-moz-none";a.style.webkitUserSelect="none";a.style.KhtmlUserSelect="none";a.style.msUserSelect="none";a.onselectstart=function(c){if(!c){c=getWndOfDom(this).event;}return["input","textarea"].indexOf((c.srcElement||c.target).nodeName.toLowerCase())!==-1;};}}function getStrWidth(d){var a=d.length;var b=0;for(var c=0;c<a;c++){if(d.charCodeAt(c)>=255){b+=2;}else{b+=1;}}return b;}function getFileIcon(c){var a={"htm":"html.gif","html":"html.gif","asp":"html.gif","jsp":"html.gif","txt":"txt.gif","css":"txt.gif","js":"txt.gif","xml":"xml.gif","conf":"txt.gif","json":"txt.gif","gif":"gif.gif","jpg":"jpg.gif","jpeg":"jpg.gif","pdf":"pdf.gif","png":"png.gif","bmp":"bmp.gif","portal":"biportal.gif","bat":"bat.gif","cmd":"bat.gif","exe":"exe.gif","com":"exe.gif","doc":"word.gif","docx":"word.gif","dot":"word.gif","xls":"excel.gif","vsd":"visio.gif","ppt":"powerpoint.gif","ldb":"access.gif","one":"onenote.gif","mdb":"access.gif","mpp":"access.gif","npf":"fix_r.gif","rpt":"fix_r.gif","olap":"easyolap_r.gif","qbe":"easyqbe_r.gif","link":"link.gif","csv":"csv.gif","zip":"zip.gif","rar":"zip.gif","frontpage":"frontpage.gif","groove":"groove.gif","infopath":"infopath.gif","outlook":"outlook.gif","project":"project.gif","publisher":"publisher.gif","esp":"esp.gif"};getFileIcon=function(e){var d=a[e]||"none.gif";return sys.getImgPath("file/"+d);};var b=!!c?c.toLowerCase():c;return getFileIcon(b);}function rndIdentity(b,c){var a=new Date().getTime();rndIdentity=function(e,f){a=(a*69069)%2147483648;var d=(a/2147483648).toString().replace(/\w\./,"");if(e){d=e+d;}if(f){d=d+f;}return d;};return rndIdentity(b,c);}function isPlainObject(c){if(typeof(c)!=="object"||c.nodeType||"setInterval" in c){return false;}try{if(c.constructor&&!c.hasOwnProperty("constructor")&&!c.constructor.prototype.hasOwnProperty("isPrototypeOf")){return false;}}catch(b){return false;}var a;for(a in c){}return a===undefined||c.hasOwnProperty(a);}function isEmptyObject(b){for(var a in b){return false;}return true;}function extendObj(){var f=arguments[0],d=1,j=false,e=arguments.length;if(isBoolean(f)){j=f;f=arguments[1]||{};d=2;}if(!isObject(f)&&!isFunction(f)){f={};}var k=null,c=null,a=null,b=null,h=null,g=false;for(;d<e;d++){if((k=arguments[d])==null){continue;}for(c in k){a=f[c];b=k[c];if(a===b){continue;}if(j&&b&&(isPlainObject(b)||(g=isArray(b)))){if(g){g=false;h=isArray(a)?a:[];}else{h=isPlainObject(a)?a:{};}f[c]=extendObj(j,h,b);}else{if(b!==undefined){f[c]=b;}}}}return f;}function addClassName(c,b){if(!c||!b){return;}var a=c.className;a=a?a.split(" "):[];b.split(" ").forEach(function(d){if(d&&this.indexOf(d)===-1){this.push(d);}},a);c.className=a.join(" ");}function removeClassName(c,b){if(!c||!b){return;}var a=c.className;if(!a){return;}a=a.split(" ");b.split(" ").forEach(function(e){var d=this.indexOf(e);if(d!==-1){this.splice(d,1);}},a);c.className=a.join(" ");}function hasClassName(c,b){if(!c||!b){return;}var a=c.className;if(!a){return false;}return a.split(" ").indexOf(b)!==-1;}function toggleClassName(e,d){if(!e||!d){return;}var f=d.split(" ");if(f.length>1){f.forEach(function(g){toggleClassName(this,g);},e);return;}var c=(e.className||"").split(" "),b=c.indexOf(d),a=null;if(b===-1){c.push(d);a=true;}else{c.splice(b,1);a=false;}e.className=c.join(" ");return a;}function transStr2Function(evtstr,option){var getHandler=function(obj,names){names=names.split(".");for(var i=0,len=names.length;obj&&i<len;i++){obj=obj[names[i]];}return typeof(obj)=="function"?obj:null;};transStr2Function=function(evtstr,option){if(!evtstr){return null;}var type=typeof(evtstr);if(type!="string"){return type=="function"?evtstr:null;}if(!evtstr.trim()){return null;}var func=null;try{if(/^\w+(\.\w+)*$/.test(evtstr)){var objs=null;if(option){objs=option["objs"];}if(!objs){objs=[window];}else{if(Object.prototype.toString.call(objs)!="[object Array]"){objs=[objs];}}for(var i=0,len=objs.length;!func&&i<len;i++){func=getHandler(objs[i],evtstr);}}else{evtstr=evtstr.replace(/^\/\/.*(\r\n|\n|$)/mg,"");if(/^function\s*\(/.test(evtstr)){func=window.eval("(function(){\r\n return "+evtstr+"\r\n})()");}else{var args=null;if(option){args=option["args"];}if(!args){args=["p"];}else{if(Object.prototype.toString.call(args)!="[object Array]"){args=[args];}}args.push(evtstr);func=Function.apply(this,args);}}}catch(e){e.message=I18N.getString("esmain.pagedesigner.js.portalutil.js.wrongis","错误：")+'<span style="color: red">'+e.message+"</span>\r\n"+'<div style="padding: 0px 30px;color:#666">'+I18N.getString("esmain.pagedesigner.js.portalutil.js.checkformat","请检查自定义事件格式，内容如下：")+"\r\n"+'<pre style="padding: 3px 10px;color: #333;font-family:Verdana !important">'+evtstr+"</pre></div>";showError(e);}return func||null;};return transStr2Function(evtstr,option);}function isChildNode(b,a,d,c){if(!b||!a){return false;}if(b===a){return !!d;}c=parseInt(c);if(isNaN(c)){do{a=a.parentNode;if(a===b){return true;}}while(a);}else{do{a=a.parentNode;if(a===b){return true;}}while(a&&(--c)>0);}return false;}function getNextElementSibling(b){var a=b.nextElementSibling;if(a){return a;}a=b.nextSibling;while(a&&a.nodeType!==1){a=a.nextSibling;}return a;}function getZoomnumFromWin(c){c=c?c:window;var a=c.screen.width;var b=0;return b=a/1024;}function banBackSpace(a){var a=a||window.event;if(a.keyCode==8){var d=a.target||a.srcElement;var c=d.type||d.getAttribute("type");if(c!="password"&&c!="text"&&c!="textarea"){return false;}var e=d.getAttribute("readonly");var b=d.getAttribute("enabled");e=e==null?false:e;b=b==null?true:b;if(e===true||b===false){return false;}}}if(isie||isChrome){addEvent(document,"keydown",banBackSpace);}else{addEvent(document,"keypress",banBackSpace);}function setVmlNamespace(){if(isie&&ieVersion<9){if(ieVersion==8){document.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML");}else{document.namespaces.add("v","urn:schemas-microsoft-com:vml");}var a=document.createStyleSheet();a.cssText="v\\:*{behavior:url(#default#VML);position:absolute;disply:block}";}}function toDecimalN(a,e){var d=parseFloat(a);if(isNaN(d)){return false;}var d=Math.round(a*Math.pow(10,e))/Math.pow(10,e);var c=d.toString();var b=c.indexOf(".");if(e==0){return c;}if(b<0){b=c.length;c+=".";}while(c.length<=b+e){c+="0";}return c;}function parsePercent(a){if(typeof a==="string"){if(a.replace(/^\s+/,"").replace(/\s+$/,"").match(/%$/)){return parseFloat(a)/100;}return parseFloat(a);}return a;}function isPercent(a){return a?a.trim().match(/%$/):false;}